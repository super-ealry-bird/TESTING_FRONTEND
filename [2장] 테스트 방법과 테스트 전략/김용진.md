# [2장] 테스트 방법과 테스트 전략

---

## 2.1 테스트 범위와 목적
테스트의 범위와 목적을 이해해야 테스트 자동화의 장점까지 누릴 수 있다.

### 2.1.1 테스트 범위
테스트 범위는 크게 4가지

[[1] 정적 분석](#221-정적-분석) <br>
[[2] 단위 테스트](#222-단위-테스트) <br>
[[3] 통합 테스트](#223-통합-테스트) <br>
[[4] E2E 테스트](#224-E2E-테스트) <br>

### 2.1.2 테스트 목적
테스트 타입은 목적에 따라 분류된다.

[[1] 기능 테스트](#231-기능-테스트-인터랙션-테스트) <br>
[[2] 비기능 테스트](#232-비기능-테스트접근성-테스트) <br>
[[3] 회귀 테스트](#233-시각적-회귀-테스트) (시각적 회귀 테스트) <br>
특정 시점을 기준으로 전후 차이를 비교하여 검증하는 테스트.
> 프런트엔드는 시각적 회귀 테스트가 중요하다.

---

## 2.2 프런트엔드 테스트의 범위

### 2.2.1 정적 분석
타입스크립트나 ESLint가 제공하는 기능을 활용하여, 소스 코드의 실행 없이 정적으로 프로그램의 문제를 찾는다.<br>

### 2.2.2 단위 테스트
특정 입력값을 받아 기대하는 출력값을 반환하는지 테스트한다.<br>
'이런 상황은 일어날 수 없을까? 일어날 수 있다면 어떻게 처리해야 하는가' 같은 미처 고려하지 못했던 부분을 발견할 수 있다.
![image](https://github.com/user-attachments/assets/399dda8b-9d8b-4b02-b40d-e001cd5d8fb0) <br>
(출처: 제이펍 jpub.kr)

### 2.2.3 통합 테스트
모듈 조합으로 제공되는 기능을 검증하는 테스트. <br> 
범위가 넓어질수록 효율적인 테스트, 좁은 범위의 테스트가 효율적일 때도 있다.

> 🤔 범위가 넓어질수록 효율적? 좁은 범위 테스트가 효율적?

### 2.2.4 E2E 테스트
UI 테스트뿐만 아니라 외부 스토리지와 같이 연동 중인 하위 시스템을 포함하는 테스트다.<br>
실제로 애플리케이션을 사용할 때와 가장 유사한 테스트이기도 하다.

--- 

## 2.3 프런트엔드 테스트 목적

### 2.3.1 기능 테스트 (인터랙션 테스트)
웹 프런트엔드의 기능테스트는 인터랙션 테스트가 대부분이다.

브라우저가 없어도 가능한 인터랙션 테스트
- 버튼을 클릭하면 콜백 함수가 호출된다.
- 문자를 입력하면 전송 버튼이 활성화 된다.
- 로그아웃 버튼을 클릭하면 로그인 화면으로 이동한다.

![image](https://github.com/user-attachments/assets/6a54b5e5-6eb6-4125-97b9-6b167d25b3a4) <br>
(출처: 제이펍 jpub.kr)

브라우저가 필요한 인터랙션 테스트
- 스크롤을 내리면 추가 데이터를 가져온다.
- 세션 스토리지에 저장된 값을 불러온다.

![image](https://github.com/user-attachments/assets/16c8144f-1dee-4513-aca8-b6b01ed9987c) <br>
(출처: 제이펍 jpub.kr)


> 💡 **인터랙션 테스트**
> 
> 웹 애플리케이션이나 UI 에서 사용자와 시스템 간의 상호작용을 테스트하는 것

### 2.3.2 비기능 테스트(접근성 테스트)

![image](https://github.com/user-attachments/assets/7df05727-6b0f-4955-b6ac-c179a8caef2e) <br>
(출처: 제이펍 jpub.kr)

> 📖 주요 접근성
> - 인식 가능 : 대체 텍스트, 캡션, 적절한 색 대비
> - 운용 가능 : 키보드 접근, 충분한 시간
> - 이해 가능 : 예측 가능한 내비게이션, 입력 도움말
> - 견고성 : 표준 html/css 사용, 호환성 유지

### 2.3.3 시각적 회귀 테스트
헤드리스 브라우저에 그려진 내용을 캡처하여 캡처된 이미지 간 차이를 검증한다.

> ✔ 저장된 이미지와 렌더링 결과물이 기존과 동일하게 출력되는지를 보장받을 수 있는 테스트입니다.

---

## 2.4 테스트 전략 모델
테스트 계층 간 비용 분배는 테스트 전략을 세울 때 가장 중요한 검토 사항이다.

![image](https://github.com/user-attachments/assets/f082fbe4-6363-4f4e-81db-8f9d9030f5f4) <br>
(출처: 제이펍 jpub.kr)

### 2.4.1 아이스크림 콘과 테스트 피라미드

![image](https://github.com/user-attachments/assets/a4b05699-5f11-4485-8019-9f0e3fa66b71) <br>
(출처: 제이펍 jpub.kr)

- 아이스크림 모델 : 상층부 테스트의 비중이 높음. 테스트 실행 기간이 길어서 신속성이 떨어진다.
- 피라미드 모델 : 하층부 테스트 비중이 높음. 신속성이 높기 때문에 자주 실행할 수 있어서 안정성도 높아진다

프런트엔드 테스트 자동화에도 피라미드가 우수한 전략이라는 의견이 지배적이다.

### 2.4.2 테스팅 트로피
프런트엔드 개발에서 단일 UI 컴포넌트로 구현되는 기능은 거의 없다. 테스팅 트로피 모델에는 사용자 조작을 기점으로 한 통합 테스트 비중이 높을수록 더욱 우수한 테스트 전략이라는 의도가 있다. <br>
제스트를 사용하면 헤드리스 브라우저 없이도 사용자 조작을 재현해 실행 속도가 빠르면서도 실제 제품과 유사한 테스트가 가능하다.

![image](https://github.com/user-attachments/assets/f8edd887-2f9e-410e-ae41-812b10bfe2a5) <br>
(출처: 제이펍 jpub.kr)

> 💡 테스팅 트로피 모델 더 적합한 애플리케이션
> - 다양한 컴포넌트와 서비스가 상호작용하는 복잡한 애플리케이션.
> - 실제 사용자 시나리오를 충분히 검증해야 하는 경우.

---

## 2.5 테스트 전략 계획
최적의 전략을 수립하려면 테스트 대상 및 목적에 따른 판단 기준을 정립해야한다.

### 2.5.1 테스트 없이 리팩터링이 불안한 경우
작성된 회귀 테스트가 있으면 변경 전후로 결함이 발생하지 않았는지 검증이 가능하여 자신감 있게 리팩터링을 시작할 수 있다. <br>
목 서버를 활용하여 웹 API 서버에 대한 의존성을 분리하고 통합 테스트 테스트 코드를 작성한다.

### 2.5.2 반응형으로 제작된 프로젝트
하나의 파일로 여러 화면을 제공하면 PC용 디자인만 수정하려고 했으나 모바일 디자인까지 수정되는 상황이 발생한다.<br>
반응형 웹은 세밀한 테스트가 어렵다. 렌더링 결과를 검증할 브라우저 테스트가 필요하다. <br>
8장, 9장에서 스토리북, reg-suit를 활용한 시각적 회귀 테스트를 알아보겠다.  

> 💡 **스토리북** : UI 컴포넌트를 독립적으로 개발할 수 있게 하고, 문서화하며, 시각적 테스트를 할 수 있게 합니다.<br> 
> 💡 **reg-suit** : 시각적 회귀 테스트를 통해 UI 변경 사항을 확인할 수 있게 합니다.

### 2.5.3 데이터베이스를 포함한 E2E 테스트가 필요한 경우
목 서버가 아닌 웹 API 서버를 사용해서 E2E 테스트가 하고 싶다면 실제 배포 환경에 가까운 형태로 만든 테스트용 환경이 필요하다.
컨테이너 가상화를 이용하여 로컬 환경에서 테스트를 실행할 수 있다.

> 💡 테스트를 너무 많이 작성하는 것이 아닌지 되돌아보자
> > 여러 종류의 테스트를 작성하다 보면 중복되는 것을 발견할 수 있다. <br>
> > 지나치게 많이 작성한 테스트를 발견했다면 과감하게 줄여야 한다. <br>
> > 테스트 전략이 프로젝트에 알맞은지 항상 되돌아보자.
