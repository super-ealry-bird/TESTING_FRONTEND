# Chapter 10. E2E í…ŒìŠ¤íŠ¸

## 10.1 E2E í…ŒìŠ¤íŠ¸ë€
> í”„ë¡ íŠ¸ì—”ë“œì—ì„œ E2E í…ŒìŠ¤íŠ¸ëŠ” ë¸Œë¼ìš°ì €ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê¸°ì— ì‹¤ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ê°€ê¹Œìš´ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
> ë¸Œë¼ìš°ì € ê³ ìœ ì˜ API ë¥¼ ì‚¬ìš©í•˜ëŠ” ìƒí™©ì´ë‚˜ í™”ë©´ì„ ì´ë™í•˜ë©° í…ŒìŠ¤íŠ¸í•˜ëŠ” ìƒí™©ì— ì í•©

- ë¸Œë¼ìš°ì € ê³ ìœ  ê¸°ëŠ¥ê³¼ ì—°ë„ëœ UI í…ŒìŠ¤íŠ¸
- ë°ì´í„°ë² ì´ìŠ¤ ë° í•˜ìœ„ ì‹œìŠ¤í…œê³¼ ì—°ë™ëœ E2E í…ŒìŠ¤íŠ¸


â­ï¸ ë¬´ì—‡ì„ í…ŒìŠ¤íŠ¸í• ì§€ ëª©ì ì„ ëª…í™•íˆ ì„¸ìš°ê¸° > **ì „ì²´ êµ¬ì¡°ì—ì„œ ì–¼ë§ˆë‚˜ ì‹¤ì œì™€ ìœ ì‚¬í•œ ìƒí™©ì„ ì¬í˜„í•  ê²ƒì¸ì§€ê°€ ì¤‘ìš”í•œ ê¸°ì¤€ì ** â­ï¸ 

<br/>

### 10.1.1 ë¸Œë¼ìš°ì € ê³ ìœ  ê¸°ëŠ¥ê³¼ ì—°ë™í•œ UI í…ŒìŠ¤íŠ¸
> í™”ë©´ ê°„ì˜ ì´ë™ / í™”ë©´ í¬ê¸°ë¥¼ ì¸¡ì •í•´ì„œ ì‹¤í–‰ë˜ëŠ” ë¡œì§ / CSSì˜ ë¯¸ë””ì–´ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•œ ë°˜ì‘í˜• ì²˜ë¦¬ / ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì— ë”°ë¥¸ ì´ë²¤íŠ¸ ë°œìƒ / ì¿ í‚¤ë‚˜ ë¡œì»¬ ì €ì¥ì†Œë“±ì— ë°ì´í„°ë¥¼ ì €ì¥
>
> ê³¼ ê°™ì€ ìƒí™©ì—ì„œëŠ” jsdom ì—ì„œ ì œëŒ€ë¡œ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ì—†ë‹¤!

ğŸ’¡ ìƒí™©ì— ë”°ë¼ ë¸Œë¼ìš°ì €ë¡œ ì‹¤ì œ ìƒí™©ê³¼ ìµœëŒ€í•œ ìœ ì‚¬í•˜ê²Œ í…ŒìŠ¤íŠ¸í•˜ê³  ì‹¶ì„ ë•ŒëŠ” **UI í…ŒìŠ¤íŠ¸** ë¥¼ í•˜ë©´ ëœë‹¤.

- API ì„œë²„, í•˜ìœ„ ì‹œìŠ¤í…œì€ ëª© ì„œë²„ë¥¼ ë§Œë“¤ì–´ E2E í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ì—ì„œ ì—°ë™ëœ ê¸°ëŠ¥ì„ ê²€ì¦ > **í”¼ì²˜ í…ŒìŠ¤íŠ¸**

<br/>

### 10.1.2 ë°ì´í„°ë² ì´ìŠ¤ ë° ì„œë¸Œ ì‹œìŠ¤í…œê³¼ ì—°ë™í•œ E2E í…ŒìŠ¤íŠ¸
> E2E í…ŒìŠ¤íŠ¸ : ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ë‚˜ ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ì—°ë™í•œ ì‹¤ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ìœ ì‚¬í•˜ê²Œ ì¬í˜„í•´ ê²€ì¦í•˜ëŠ” í…ŒìŠ¤íŠ¸

 - ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ ì—°ë™ (ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°/ì €ì¥í•˜ê¸°)
 - ì™¸ë¶€ ì €ì¥ì†Œ ì„œë¹„ìŠ¤ ì—°ë™ (ì´ë¯¸ì§€ ë“± ì—…ë¡œë“œ)
 - ë ˆë””ìŠ¤ì™€ ì—°ë™ (ì„¸ì…˜ ê´€ë¦¬)


| ê³„ì¸µ        | ì„¤ëª…                                                |
|-------------|-----------------------------------------------------|
| í‘œí˜„ ê³„ì¸µ   | ì‚¬ìš©ìì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ë¶€ë¶„ìœ¼ë¡œ, UIë‚˜ API ì¸í„°í˜ì´ìŠ¤ë¥¼ ë‹´ë‹¹í•©ë‹ˆë‹¤. |
| ì‘ìš© ê³„ì¸µ   | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•˜ë©°, í‘œí˜„ ê³„ì¸µê³¼ ì˜ì† ê³„ì¸µì„ ì¤‘ì¬í•©ë‹ˆë‹¤.      |
| ì˜ì† ê³„ì¸µ   | ë°ì´í„°ë¥¼ ì˜êµ¬ì ìœ¼ë¡œ ì €ì¥í•˜ê³  ê´€ë¦¬í•˜ëŠ” ê³„ì¸µìœ¼ë¡œ, DBì™€ì˜ ìƒí˜¸ì‘ìš©ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤. |

ğŸ’¡ í‘œí˜„/ì‘ìš©/ì˜ì† ê³„ì¸µì„ ì—°ë™í•˜ì—¬ ê²€ì¦í•˜ë¯€ë¡œ ì‹¤ì œ ìƒí™©ê³¼ ìœ ì‚¬ì„±ì´ ë†’ë‹¤ëŠ” ì¥ì ì´ ìˆì§€ë§Œ, ë§ì€ ì‹œìŠ¤í…œê³¼ ì—°ë™í•˜ê¸°ì— ì‹¤í–‰ ì‹œê°„ì´ ê¸¸ê³ , ë¶ˆì•ˆì •í•˜ë‹¤ëŠ” ë‹¨ì ë„ ì¡´ì¬í•œë‹¤.

<br/>


### 10.1.3 ì´ë²ˆ ì¥ì—ì„œ ë‹¤ë£¨ëŠ” E2E í…ŒìŠ¤íŠ¸
> E2E í…ŒìŠ¤íŠ¸ì— ë„ì»¤ ì»´í¬ì¦ˆë¥¼ ë„ì…í•˜ë©´ í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ì‹¤í–‰í•˜ê³  ì¢…ë£Œí•˜ëŠ”ê²ƒì´ í¸ë¦¬

- ì˜ˆì œ docker-compose.e2e.yaml íŒŒì¼ì„ ë³´ë©´ ì—°ë™í•  ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„, ë ˆë””ìŠ¤ ì„œë²„ ê´€ë ¨ ì½”ë“œê°€ ì‘ì„±ë˜ì–´ìˆë‹¤.

<br />

---

<br />

## 10.2 í”Œë ˆì´ë¼ì´íŠ¸ ì„¤ì¹˜ ë° ê¸°ì´ˆ
https://github.com/frontend-testing-book-kr/playwright 

> í”Œë ˆì´ë¼ì´íŠ¸ : ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ê°€ ê³µê°œí•œ E2E í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬

- í¬ë¡œìŠ¤ ë¸Œë¼ìš°ì§• ì§€ì›
- ë””ë²„ê¹… í…ŒìŠ¤íŠ¸
- ë¦¬í¬í„°
- íŠ¸ë ˆì´ìŠ¤ ë·°ì–´
- í…ŒìŠ¤íŠ¸ ì½”ë“œ ìƒì„±ê¸°


<br/>

### 10.2.1 ì„¤ì¹˜ ë° ì„¤ì •
https://github.com/frontend-testing-book-kr/playwright 

<img width="810" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-09-24 22 46 11" src="https://github.com/user-attachments/assets/9c7bb8e2-414d-44ad-a572-f4b357f10f92">


ğŸ’¡ ì„¤ì¹˜ ì™„ë£Œ ì‹œ package.json ì— ëª¨ë“ˆ ì¶”ê°€ + ì„¤ì • íŒŒì¼ ì–‘ì‹, ì˜ˆì œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ìƒì„±

<br/>

### 10.2.2 ì²˜ìŒ ì‹œì‘í•˜ëŠ” E2E í…ŒìŠ¤íŠ¸

> [GET STARTED] ë²„íŠ¼ì„ í´ë¦­í•´ì„œ ê³µì‹ ë¬¸ì„œ í˜ì´ì§€ë¡œ ì´ë™í•  ìˆ˜ ìˆëŠ”ì§€ ê²€ì¦ 

```typescript
test("has title", async ({ page }) => {
  await page.goto("https://playwright.dev/"); // í”Œë ˆì´ë¼ì´íŠ¸ ê³µì‹ ë¬¸ì„œ í˜ì´ì§€

  // í˜ì´ì§€ ì œëª©ì— "Playwright"ê°€ í¬í•¨ëëŠ”ì§€ ê²€ì¦í•œë‹¤.
  await expect(page).toHaveTitle(/Playwright/);
});

test("get started link", async ({ page }) => {
  await page.goto("https://playwright.dev/");

  // "Get started"ë¼ëŠ” ì ‘ê·¼ ê°€ëŠ¥í•œ ì´ë¦„ì„ ê°€ì§„ ë§í¬ë¥¼ ì·¨ë“í•˜ê³ , ë§í¬ë¥¼ í´ë¦­í•œë‹¤.
  await page.getByRole("link", { name: "Get started" }).click();

  // í˜ì´ì§€ URLì— "intro"ê°€ í¬í•¨ëëŠ”ì§€ ê²€ì¦í•œë‹¤.
  await expect(page).toHaveURL(/.*intro/);
});
```

<br />

### 10.2.3 ë¡œì¼€ì´í„°
> ë¡œì¼€ì´í„° : í”Œë ˆì´ë¼ì´íŠ¸ì˜ í•µì‹¬ API > í˜„ì¬ í˜ì´ì§€ì—ì„œ íŠ¹ì • ìš”ì†Œë¥¼ ê°€ì ¸ì˜¤ëŠ” ì—­í• 

_1.27.0 ë²„ì „ì—ëŠ” í…ŒìŠ¤íŒ… ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œë¶€í„° ì˜í–¥ì„ ë°›ì€ ì ‘ê·¼ì„± ê¸°ë°˜ ë¡œì¼€ì´í„° ì¶”ê°€ (all, and, blur, clear, or, pressSequentially)_

ğŸ’¡ í…ŒìŠ¤íŒ… ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì¿¼ë¦¬ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì ‘ê·¼ì„± ê¸°ë°˜ ë¡œì¼€ì´í„°ë¥¼ ìš°ì„ ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê¶Œì¥ ! 

```typescript
test("ì½”ë“œ 10-2",async ({ page }) => {
  await page.getByLabel("User Name").fill("John");
  await page.getByLabel("Password").fill("secret-password");
  await page.getByRole("button", { name: "Sign in" }).click(); //ì ‘ê·¼ ê°€ëŠ¥í•œ ì´ë¦„ìœ¼ë¡œ ë²„íŠ¼ ì·¨ë“ + í´ë¦­
})
```

**í…ŒìŠ¤íŒ… ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ë‹¤ë¥¸ì **
- ëŒ€ê¸° ì‹œê°„ì˜ í•„ìš”í•¨ì— ë”°ë¼ findByRole êµ¬ë¶„ í•„ìš” ì—†ìŒ
- await ë¡œ ì¸í„°ë™ì…˜ ì™„ë£Œê¹Œì§€ ê¸°ë‹¤ë¦° í›„ ë‹¤ìŒ ì¸í„°ë™ì…˜ ì‹¤í–‰í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ë™

<br />

### 10.2.4 ë‹¨ì–¸ë¬¸
> ëª…ì‹œì ìœ¼ë¡œ expectë¥¼ import gotj wkrtjd

```typescript
test("Locatorë¥¼ ì‚¬ìš©í•œ ë‹¨ì–¸ë¬¸ ì‘ì„±ë²•",async ({ page }) => {
  // íŠ¹ì • ë¬¸ìì—´ì„ ê°€ì§„ ìš”ì†Œë¥¼ ì·¨ë“í•´ì„œ í™”ë©´ì— ë³´ì´ëŠ” ìƒíƒœì¸ì§€ ê²€ì¦í•œë‹¤.
  await expect(page.getByText("Welcome, John!")).toBeVisible();
  // ì²´í¬ë°•ìŠ¤ì²´í¬ ë°•ìŠ¤ë¥¼ ì·¨ë“í•´ì„œ ì²´í¬ë˜ì–´ ìˆëŠ”ì§€ëëŠ”ì§€ ê²€ì¦í•œë‹¤.
  await expect(page.getByRole("checkbox")).toBeChecked();
  // notìœ¼ë¡œ ì§„ë¦¿ê°’ì„ ë°˜ì „ì‹œí‚¨ë‹¤.
  await expect(page.getByRole("heading")).not.toContainText("some text");
})
```
( jest ì™€ ë™ì¼í•˜ê²Œ not ì„ ì‚¬ìš©í•´ì„œ ì§„ë¦¿ê°’ ë°˜ì „ )

<br />

```typescript
test("í˜ì´ì§€ë¥¼ ì‚¬ìš©í•œ ë‹¨ì–¸ë¬¸ ì‘ì„±ë²•",async ({ page }) => {
  // í˜ì´ì§€ URLì— "intro"ê°€ í¬í•¨ëëŠ”ì§€ ê²€ì¦í•œë‹¤.
  await expect(page).toHaveURL(/.*intro/);
  // í˜ì´ì§€ ì œëª©ì— "Playwright"ê°€ í¬í•¨ëëŠ”ì§€ ê²€ì¦í•œë‹¤.
  await expect(page).toHaveTitle(/Playwright/);
})
```
( expect ì˜ ì¸ìˆ˜ì— í˜ì´ì§€ë¥¼ í• ë‹¹í•˜ì—¬ ê²€ì¦ìš© ë§¤ì²˜ë¥¼ ì¶”ì²œ )

<br />

---

<br />

## 10.3 í…ŒìŠ¤íŠ¸í•  ì• í”Œë¦¬ì¼€ì´ì…˜
> ë ˆë””ìŠ¤ ì„œë²„, ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„, ì™¸ë¶€ ì €ì¥ì†Œ ì„œë¹„ìŠ¤ì™€ ì—°ë™í•´ì•¼ í•œë‹¤.

<br />

### 10.3.1 ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œìš”
> ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•˜ì—¬ ê¸°ìˆ  ê´€ë ¨ ê¸°ì‚¬ë¥¼ ì‘ì„±í•˜ê³  í¸ì§‘í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜
> 
> ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ì‘ì„±í•œ ê¸°ì‚¬ì— [like] ë²„íŠ¼ì„ ëˆ„ë¥¼ ìˆ˜ ìˆê³  íšŒì›ê°€ì… ê¸°ëŠ¥ (X) ë¡œê·¸ì¸í•œ ì‚¬ìš©ìëŠ” í”„ë¡œí•„ í¸ì§‘ (O)

1. **Next.js**

   ëª¨ë“  í˜ì´ì§€ë¥¼ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ (SSR) ìœ¼ë¡œ ë Œë”ë§í•˜ë©° ì¸ì¦ëœ ìš”ì²­ì¸ì§€ ê²€ì‚¬
   (ë§Œì•½ ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ìƒíƒœì´ë©´ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸)
   ë ˆë””ìŠ¤ ì„œë²„ì™€ ì—°ë™í•˜ì—¬ ì„¸ì…˜ìœ¼ë¡œë¶€í„° ì‚¬ìš©ì ì •ë³´ë¥¼ ì·¨ë“

2. **í”„ë¦¬ì¦ˆë§ˆ**

   PostgreSQL (ê´€ê³„í˜• DB) ë¥¼ ì‚¬ìš©
   Next.js ì„œë²„ëŠ” ê°ì²´ ê´€ê³„ ë§¤í•‘ (ORM) ë„êµ¬ë¡œ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì™€ í˜¸í™˜ì„±ì´ ì¢‹ì€ í”„ë¦¬ì¦ˆë§ˆ ì‚¬ìš©
   (ì´ë„ˆ ì¡°ì¸í•œ í…Œì´ë¸”ì˜ ì‘ë‹µì„ íƒ€ì… ì¶”ë¡ ìœ¼ë¡œ íšë“í•  ìˆ˜ ìˆì–´ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ í”„ë¡œì íŠ¸ì—ì„œ ì¸ê¸°ê°€ ë§ì€ ì˜¤í”ˆì†ŒìŠ¤)

3. **S3 Client**

   ì™¸ë¶€ íŒŒì¼ ì €ì¥ì†Œ ì„œë¹„ìŠ¤ë¡œëŠ” AWS S3 ì‚¬ìš©
   ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” AWS S3 API ì™€ í˜¸í™˜ì´ ê°€ëŠ¥í•œ MinIO ì‚¬ìš©
   (ê¸°ì‚¬ì˜ ë©”ì¸ ë° í”„ë¡œí•„ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ëŠ” ê³µê°„ìœ¼ë¡œ í™œìš©


<br />

### 10.3.2 ë¡œì»¬ ê°œë°œ í™˜ê²½ ì„¤ì • ìˆœì„œ

https://github.com/frontend-testing-book-kr/nextjs

```shell
npm i
```

1. **MinIO Client ì„¤ì¹˜**

   ë¡œì»¬ í™˜ê²½ìš© S3 ì¸ MinIO ì‚¬ìš©
   ```shell
   brew install minio/stable/mc
   ```

2. **ë„ì»¤ ì»´í¬ì¦ˆë¡œ ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆ ì‹¤í–‰í•˜ê¸°**

   ë„ì»¤ ì»´í¬ì¦ˆ íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ë¡œì»¬ í™˜ê²½ì—ì„œ ì‚¬ìš©
   ```shell
   docker compose up -d
   ```

   <br />

   ë„ì»¤ ì»´í¬ì¦ˆë¡œ ì‹¤í–‰í•œ MinIO ì„œë²„ì— ë²„í‚· ìƒì„±í•˜ê¸°
   ```shell
   sh create-image-bucket.sh
   ```
   
   <br />

   ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ í›„ í…ŒìŠ¤íŠ¸ìš© ì´ˆê¸° ë°ì´í„° ì£¼ì…
   ```shell
   npm run prisma:migrate
   ```
   
   <br />

   Next.js ê°œë°œì„œë²„ ì‹¤í–‰ (http://localhost:3000/)
   ```shell
   npm run dev
   ```


<br />

---

<br />

## 10.4 ê°œë°œ í™˜ê²½ì—ì„œ E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰í•˜ê¸°
> E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰í•´ë³´ê¸°

<br />

### 10.4.1 E2E í…ŒìŠ¤íŠ¸ ì„¤ì •
> ê°œë°œ í™˜ê²½ì—ì„œ E2E í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤ì‹œí•˜ë ¤ë©´ ë¹Œë“œëœ Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ (docker compose up -d ì‹¤í–‰ ìƒíƒœ)

```shell
npm run build && npm start
```
<br />

E2E í…ŒìŠ¤íŠ¸ ì´ì „ì— ë°ì´í„°ë² ì´ìŠ¤ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì´ˆê¸°í™” (í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œ ë°ì´í„°ê°€ ë³€ê²½ë¼ ì´í›„ ì‹¤í–‰í•˜ëŠ” í…ŒìŠ¤íŠ¸ì— ì˜í–¥ì„ ë¯¸ì¹˜ê¸° ë•Œë¬¸ì—)

```shell
npm run prisma:reset
```

<br />

### 10.4.2 E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰
> E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```shell
// ì´ˆê¸° ì„¤ì • ì‚¬ìš© ì‹œ í—¤ë“œë¦¬ìŠ¤ ëª¨ë“œë¡œ E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰í•˜ê¸°ì— ë¸Œë¼ìš°ì €ëŠ” ë‚˜íƒ€ë‚˜ì§€ ì•ŠëŠ”ë‹¤!
npx plawright test
```

ğŸ’¡ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ë¦¬í¬íŠ¸ë¡œ ìƒì„±í•˜ê³  ì‹¶ìœ¼ë©´ `npx playwright show-report` ëª…ë ¹ì–´ë¥¼ í†µí•´ `http://localhost:9223/` ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

```shell
// íŠ¹ì • í…ŒìŠ¤íŠ¸ íŒŒì¼ëª…ì„ ì¸ìˆ˜ë¡œ ì§€ì •í•˜ë©´ í•´ë‹¹ íŒŒì¼ì—ë§Œ í…ŒìŠ¤íŠ¸ ì‹¤ì‹œ
npx playwright test Login.spect.ts
```

<br />

### 10.4.3 í”Œë ˆì´ë¼ì´íŠ¸ ê²€ì‚¬ ë„êµ¬ë¥¼ í™œìš©í•œ ë””ë²„ê¹…
> ìƒê°í•œ ê²ƒê³¼ ë‹¤ë¥´ê²Œ í…ŒìŠ¤íŠ¸ê°€ í†µê³¼ë˜ì§€ ì•Šì„ ë•Œ **í”Œë ˆì´ë¼ì´íŠ¸ ê²€ì‚¬ ë„êµ¬** ë¡œ ì›ì¸ íŒŒì•… í•„ìš”

â­ï¸ ì»¤ë§¨ë“œì— --debug ì˜µì…˜ì„ ë¶™ì´ë©´ headed ëª¨ë“œë¡œ í…ŒìŠ¤íŠ¸ê°€ ì‹œì‘ëœë‹¤.

```shell
npx playwright test Login.spec.ts --debug
```

ğŸ’¡ ë” ìì„¸í•œ ì‚¬ìš© ë°©ë²•ì´ ì•Œê³ ì‹¶ë‹¤ë©´ ? ê³µì‹ ë¬¸ì„œ ì°¸ê³ í•˜ê¸° 

<br />

### 10.4.4 ë„ì»¤ ì»´í¬ì¦ˆë¥¼ ì‚¬ìš©í•˜ëŠ” E2E í…ŒìŠ¤íŠ¸
> ë„ì»¤ ì»´í¬ì¦ˆë¥¼ ì‚¬ìš©í•´ì„œ E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰í•  ë•Œ

```shell
npm run docker:e2e:build && npm run docker:e2e:ci
```

<br />

---

<br />

## 10.5 í”„ë¦¬ì¦ˆë§ˆë¥¼ í™œìš©í•œ í…ŒìŠ¤íŠ¸
> ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ì™€ ì—°ë™í•˜ëŠ” ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸ ë²”ìœ„ì— í¬í•¨í•˜ì—¬ ê²€ì¦í•´ë³´ì

ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ì™€ ì—°ë™ëœ E2E í…ŒìŠ¤íŠ¸ëŠ” í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì‹œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì´ˆê¸°í™”í•˜ê³  í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°ë¥¼ ì¶”ê°€í•´ì•¼í•œë‹¤.

ğŸ’¡ ì‹œë“œ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±ë²•ê³¼ í”„ë¦¬ì¦ˆë§ˆê°€ ë¬´ì—‡ì¸ê°€?

<br />

### 10.5.1 í”„ë¦¬ì¦ˆë§ˆ ìŠ¤í‚¤ë§ˆ
> **í”„ë¦¬ì¦ˆë§ˆ ìŠ¤í‚¤ë§ˆ** ë¼ëŠ” ì—”í‹°í‹° ê°„ ê´€ê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë„ë©”ì¸ íŠ¹í™” ì–¸ì–´ (DSL) ë¥¼ ì‚¬ìš©í•´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì •ì˜
>
> í•´ë‹¹ ìŠ¤í‚¤ë§ˆ íŒŒì¼ì´ ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ë¡œ ë³€í™˜ + í”„ë¦¬ì¦ˆë§ˆ í´ë¼ì´ì–¸íŠ¸ ìƒì„±

```shell
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id             Int    @id @default(autoincrement())
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  name           String
  bio            String
  githubAccount  String
  twitterAccount String
  imageUrl       String
  email          String @unique
  password       String 
  posts          Post[]
  likes          Like[]
}

model Post {
  id          Int     @id @default(autoincrement())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  title       String
  description String?
  body        String?
  imageUrl    String?
  published   Boolean @default(false)
  author      User    @relation(fields: [authorId], references: [id])
  authorId    Int
  likes       Like[]
}
```

<br />

1. **í”„ë¦¬ì¦ˆë§ˆ í´ë¼ì´ì–¸íŠ¸ ì‚¬ìš©í•˜ê¸°**

   ìŠ¤í‚¤ë§ˆ íŒŒì¼ì„ í†µí•´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ëŠ” í”„ë¦¬ì¦ˆë§ˆ í´ë¼ì´ì–¸íŠ¸ê°€ ë¬´ì—‡ì¼ê¹Œ?

   <br />

   ```ts
   import { PrismaClient } from "@prisma/client";
   export const prisma = new PrismaClient();
   ```

   PrismaClient : prisma.schema íŒŒì¼ì— ì •ì˜ëœ ë‚´ìš©ì— ê¸°ë°˜í•œ í´ë¼ì´ì–¸íŠ¸
   - User í…Œì´ë¸” > prisma.user
   - Post í…Œì´ë¸” > prisma.post

   <br />

   - íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì™€ í˜¸í™˜ì„±ì´ ì¢‹ë‹¤ëŠ” ì¥ì 
   - prisma.schema ì— ì‘ì„±í•œ ìŠ¤í‚¤ë§ˆ ì •ì˜ëŠ” íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ íƒ€ì…ìœ¼ë¡œ ë³€í™˜ ê°€ëŠ¥
   - ì´ë„ˆ ì¡°ì¸ ê²°ê³¼ì—ë„ íƒ€ì… ì¶”ë¡ ì´ ì ìš© ê°€ëŠ¥ (ê°ì²´ ê´€ê³„ ë§¤í•‘ìœ¼ë¡œ ë§ì´ ì‚¬ìš©)
  
   <br />

   ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ìì‹ ì´ ì‘ì„±í•œ ê¸°ì‚¬ë¥¼ ì·¨ë“í•˜ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜
   ```ts
   export async function getMyPost({
   id,
   authorId,
   }: {
     id: number;
     authorId: number;
   }) {
     try {
       // ìš”ì²­í•œ IDì™€ ì¼ì¹˜í•˜ëŠ” ê¸°ì‚¬ ë°ì´í„°ë¥¼ ë°˜í™˜í•œë‹¤.
       const data = await prisma.post.findUnique({ where: { id } }); // íŠ¹ì • ID ë¥¼ ê°€ì§„ ê¸°ì‚¬ ì·¨ë“
       // ë°ì´í„°ê°€ ì—†ê±°ë‚˜ ë¯¸ë¡œê·¸ì¸ ìƒíƒœì´ë©´ Not Found ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.
       if (!data || data?.authorId !== authorId) throw new NotFoundError();
       const { createdAt, updatedAt, ...res } = data;
       // íƒ€ì… ì¶”ë¡ ì´ ë§ˆì§€ë§‰ê¹Œì§€ ì ìš©ë˜ì–´ ìˆë‹¤.
       return res;
     } catch (err) {
       handlePrismaError(err);
     }
   }
  ```
  <br />

### 10.5.2 ì‹œë“œ ìŠ¤í¬ë¦½íŠ¸ ë“±ë¡
> package.json ì— ì‹œë“œ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹œ ì ìš©í•  ì»¤ë§¨ë“œ ì‘ì„±í•´ë³´ê¸°

```shell
//ts-node ë¥¼ ê²½ìœ í•´ prisma/seed/index.ts ë¥¼ ì‹¤í–‰
  "prisma": {
    "seed": "ts-node --compiler-options {\"module\":\"CommonJS\"} prisma/seed/index.ts"
  }
```

ğŸ’¡ í”„ë¦¬ì¦ˆë§ˆ ëª…ë ¹ì¤„ ì¸í„°í˜ì´ìŠ¤ì—ì„œ ì‹œë“œ ìŠ¤í¬ë¦½íŠ¸ê°€ í•„ìš”í•  ë•Œë§ˆë‹¤ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤! 

```shell
docker-compose up -d
npm run prisma:reset
```
<br />

### 10.5.3 ì‹œë“œ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ íŒŒì¼
> í”„ë¦¬ì¦ˆë§ˆ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•´ ì´ˆê¸° ë°ì´í„° ì‘ì„± ë° ì¼ê´„ ì£¼ì… í•´ë³´ê¸°

```ts
import { PrismaClient } from "@prisma/client";
import { likes } from "./like";
import { posts } from "./post";
import { users } from "./user";

export const prisma = new PrismaClient();

const main = async () => {
  console.log(`Start seeding ...`);
  await prisma.$transaction([...users(), ...posts(), ...likes()]);
  console.log(`Seeding finished.`);
};

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
```

**await prisma.$transaction** ìœ¼ë¡œ ì¼ê´„ì ìœ¼ë¡œ ì¶”ê°€í•  ì˜ˆì •ì´ë¯€ë¡œ Promise ë°°ì—´ ë°˜í™˜

```ts
import { Like, PrismaPromise } from "@prisma/client";
import { prisma } from ".";
import { likesFixture } from "../fixtures/like";

export const likes = () => {
  const likes: PrismaPromise<Like>[] = [];
  for (const data of likesFixture()) {
    const like = prisma.like.create({ data });
    likes.push(like);
  }
  return likes;
};
```

```ts
import { Like } from "@prisma/client";

//likesFixture ëŠ” í•˜ë“œ ì½”ë”©ëœ ë°ì´í„°ë¥¼ ë°˜í™˜
export const likesFixture = (): Omit<Like, "id" | "createdAt">[] => [
  {
    userId: 1,
    postId: 1,
    authorId: 2,
  },
];
```

íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¡œ ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•˜ê±°ë‚˜ CSV ë“± ì™¸ë¶€ íŒŒì¼ì„ í”½ìŠ¤ì²˜ë¡œ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ ì‹¤í–‰ ì‹œê°„ì„ ì ìš©í•˜ë©´ í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìœ¼ë‹ˆ ê°’ì´ ë°”ë€Œì§€ ì•Šë„ë¡ ì£¼ì˜í•´ì•¼í•œë‹¤!

<br />

---

<br />

## 10.6 ë¡œê·¸ì¸ ê¸°ëŠ¥ E2E í…ŒìŠ¤íŠ¸
> ë¡œê·¸ì¸ ìƒíƒœì™€ ì—°ê´€ëœ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ë°˜ë³µì ì¸ ì‘ì—…ì„ ì–´ë–»ê²Œ ê³µí†µí™”í•˜ê³  ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ê²€ì¦í•´ì•¼í•˜ëŠ”ì§€ ì•Œì•„ë³´ì.

<br />

### 10.6.1 ë“±ë¡ ì™„ë£Œëœ ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸í•˜ê¸°
> ì‹œë“œ ìŠ¤í¬ë¦½íŠ¸ë¡œ í…ŒìŠ¤íŠ¸ìš© ì‚¬ìš©ì ì„¤ì • í›„ í…ŒìŠ¤íŠ¸ìš© ì‚¬ìš©ìë¥¼ í™œìš©í•´ í…ŒìŠ¤íŠ¸ ì‘ì„±í•´ë³´ê¸°

```ts
export async function login({ //í…ŒìŠ¤íŠ¸ìš© ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸
  page,
  userName = "JPub",
}: {
  page: Page;
  userName?: UserName;
}) {
  const user = getUser(userName)!;
  await page.getByRole("textbox", { name: "ë©”ì¼ì£¼ì†Œ" }).fill(user.email); //ì´ë¯¸ ë“±ë¡ëœ ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì™€ í¼ì— ì…ë ¥í•˜ê³  ë¡œê·¸ì¸
  await page.getByRole("textbox", { name: "ë¹„ë°€ë²ˆí˜¸" }).fill(user.password);
  await page.getByRole("button", { name: "ë¡œê·¸ì¸" }).click();
}
```

<br />

### 10.6.2 ë¡œê·¸ì¸ ìƒíƒœì—ì„œ ë¡œê·¸ì•„ì›ƒí•˜ê¸°
> í—¤ë” ë„¤ë¹„ê²Œì´ì…˜ ìš°ì¸¡ì— ìœ„ì¹˜í•œ ë¡œê·¸ì¸ëœ ì‚¬ìš©ì ì•„ë°”íƒ€ ì´ë¯¸ì§€ ìš”ì†Œ ìœ„ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ í‘œì‹œ > í´ë¦­ ì‹œ ë¡œê·¸ì•„ì›ƒ

```ts
export async function logout({
  page,
  userName = "JPub",
}: {
  page: Page;
  userName?: UserName;
}) {
  const user = getUser(userName)!;
  const loginUser = page
    .locator("[aria-label='ë¡œê·¸ì¸í•œ ì‚¬ìš©ì']")
    .getByText(user.name);
  await loginUser.hover(); //ë§ˆìš°ìŠ¤ ìœ„ì— ì˜¬ë ¤ì„œ ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ì´ ë‚˜íƒ€ë‚˜ë„ë¡ ì„¤ì •
  await page.getByText("ë¡œê·¸ì•„ì›ƒ").click();
}
```

<br />

### 10.6.3 ë¡œê·¸ì¸ ìƒíƒœê°€ ì•„ë‹ˆë©´ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ì‹œí‚¤ê¸°
> 7ê°œ í˜ì´ì§€ ì¤‘ 5ê°œëŠ” ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë§Œ ì—´ëŒí•  ìˆ˜ ìˆë„ë¡ ì œí•œ

```ts
export async function assertUnauthorizedRedirect({
  page,
  path,
}: {
  page: Page;
  path: string;
}) {
  // ì§€ì •ëœ í˜ì´ì§€ì— ì ‘ê·¼í•œë‹¤.
  await page.goto(url(path));
  // ë¦¬ë‹¤ì´ë ‰íŠ¸ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤.
  await page.waitForURL(url("/login"));
  // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í–ˆëŠ”ì§€ í™•ì¸í•œë‹¤.
  await expect(page).toHaveTitle("ë¡œê·¸ì¸ | Tech Posts");
}
```

ë¡œê·¸ì¸ ìƒíƒœê°€ ì•„ë‹ˆë©´ ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ” í˜ì´ì§€ì—ì„œ ë¯¸ë¡œê·¸ì¸ ì‚¬ìš©ìê°€ ë¦¬ë‹¤ì´ë ‰íŠ¸ëëŠ”ì§€ ê²€ì¦í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œ
```ts
test("ë¡œê·¸ì¸ ìƒíƒœê°€ ì•„ë‹ˆë©´ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ëœë‹¤", async ({ page }) => {
  const path = "/my/posts";
  await assertUnauthorizedRedirect({ page, path });
});
```

<br />

### 10.6.4 ë¡œê·¸ì¸ í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì´ì „ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°
> ë¡œê·¸ì¸ ì„±ê³µ í›„ì— ë¦¬ë‹¤ì´ë ‰íŠ¸ ì´ì „ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°

```ts
getServerSideProps ì— {redirect} ê°€ í¬í•¨ëìœ¼ë©´ destinationURL ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ (ë¦¬ë‹¤ì´ë ‰íŠ¸ ì§ì „ì— í™”ë©´ URL ì„¸ì…˜ ì €ì¥)
if (err instanceof UnauthorizedError) {
  session.redirectUrl = ctx.resolvedUrl;
  return { redirect: { permanent: false, destination: "/login" } };
}
```

ë¡œê·¸ì¸ í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì „ í˜ì´ì§€ë¡œ ëŒì•„ê°€ëŠ”ì§€ ê²€ì¦í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œ

```ts
test.describe("ë¡œê·¸ì¸ í˜ì´ì§€", () => {
  const path = "/login";

  test("ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì´ì „ í˜ì´ì§€ë¡œ ëŒì•„ê°„ë‹¤", async ({ page }) => {
    await page.goto(url("/my/posts"));
    await expect(page).toHaveURL(url(path)); //ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
    await login({ page }); //ë¡œê·¸ì¸ ì¸í„°ë™ì…˜ ì‹¤í–‰
    await expect(page).toHaveURL(url("/my/posts"));
  });
});
```

<br />

---

<br />

## 10.7 í”„ë¡œí•„ ê¸°ëŠ¥ E2E í…ŒìŠ¤íŠ¸
> ìƒˆ í”„ë¡œí•„ ì •ë³´ë¥¼ ì…ë ¥ í›„ [í”„ë¡œí•„ ë³€ê²½] ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ê°±ì‹ 
>
> ê°±ì‹ ì´ ì™„ë£Œë˜ë©´ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ì‘ì„±í•œ ê¸°ì‚¬ ëª©ë¡ í˜ì´ì§€ë¡œ ì´ë™

**E2E í…ŒìŠ¤íŠ¸ì—ì„œ í™•ì¸í•  ì—°ë™ ì‘ì—…**
- UI ë¥¼ ì¡°ì‘í•´ì„œ í”„ë¡œí•„ ê°±ì‹  API ìš”ì²­ ë°œìƒ
- API routes ê°€ ì‘ë™ + ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ì— ê°’ ì €ì¥
- ì„¸ì…˜ì— ì €ì¥ëœ ê°’ì´ ê°±ì‹ 
- ìƒˆë¡œìš´ í˜ì´ì§€ ì œëª©ì€ ê°±ì‹ ëœ ì„¸ì…˜ê°’ ì°¸ì¡°

<br />

### 10.7.1 getServerSideProps ë¡œ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ ì·¨ë“í•˜ê¸°
> ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ ìœ„í•œ ë°ì´í„° ì·¨ë“ í•¨ìˆ˜ (getServerSideProps) ëŠ” ê³ ì°¨í•¨ìˆ˜(withLogin) ì— ë˜í•‘

```ts
Page.getPageTitle = PageTitle(
  ({ data }) => `${data?.authorName}ë‹˜ì˜ í”„ë¡œí•„ í¸ì§‘`
);

// ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ì„ í¬í•¨í•œ getServerSideProps
export const getServerSideProps = withLogin<Props>(async ({ user }) => {
  return {
    // Prisma Clientë¥¼ ë˜í•‘í•œ í•¨ìˆ˜ë¥¼ í†µí•´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì·¨ë“í•œë‹¤.
    profile: await getMyProfileEdit({ id: user.id }),
    authorName: user.name, // ì œëª©ì— ì‚¬ìš©í•  ìœ ì €ëª…ì„ Propsì— í¬í•¨ì‹œí‚¨ë‹¤.
  };
});
```

user : ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì •ë³´ê°€ ì €ì¥ (ë¡œê·¸ì¸ ì •ë³´ ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„° ìš”ì²­/í”„ë¡œí•„ ì •ë³´ ì·¨ë“/ì„¸ì…˜ì— ì €ì¥ëœ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°)

<br />

### 10.7.2 í”„ë¡œí•„ ì •ë³´ë¥¼ ê°±ì‹ í•˜ëŠ” API Routes
> UI ë¥¼ ì¡°ì‘í•´ ë¹„ë™ê¸°ë¡œ ë°ì´í„° ì·¨ë“ ë° ê°±ì‹ ìš”ì²­ì„ ë°›ì•˜ì„ ë•Œ ì„œë²„ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì‘ì—…ì„ ì²˜ë¦¬í•˜ì—¬ JSON ê°™ì€ í˜•ì‹ìœ¼ë¡œ API ì‘ë‹µ ë°˜í™˜

í”„ë¡œí•„ ì •ë³´ ê°±ì‹  ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” handler í•¨ìˆ˜

updateMyProfileEdit í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë² ì´ì„œ ê°±ì‹  + ì„¸ì…˜ ì •ë³´ ê°±ì‹ 
```ts
const handlePut = withLogin<UpdateMyProfileEditReturn>(async (req, res) => {
  // ì…ë ¥ê°’ì´ ìœ íš¨í•œì§€ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì‹¤ì‹œí•œë‹¤.
  // ìœ íš¨ì„± ê²€ì‚¬ì— ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ withLogin í•¨ìˆ˜ì— ë‚´ì¥ëœ ì—ëŸ¬ í•¸ë“¤ëŸ¬ì—ì„œ ì²˜ë¦¬í•œë‹¤.
  validate(req.body, updateMyProfileEditInputSchema);
  // Prisma Clientë¥¼ ë˜í•‘í•œ í•¨ìˆ˜ë¥¼ í†µí•´ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë°ì´í„°ë¥¼ ê°±ì‹ í•œë‹¤.
  // ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ withLogin í•¨ìˆ˜ì— ë‚´ì¥ëœ ì—ëŸ¬ í•¸ë“¤ëŸ¬ì—ì„œ ì²˜ë¦¬í•œë‹¤.
  const user = await updateMyProfileEdit({
    id: req.user.id,
    input: req.body,
  });
  // ì„¸ì…˜ì— ì €ì¥ëœ ì‚¬ìš©ì ì •ë³´ë¥¼ ê°±ì‹ í•œë‹¤.
  const session = await getSession(req, res);
  session.user = { ...session.user, name: user.name, imageUrl: user.imageUrl };
  res.status(200).json(user);
});
```

<br />

### 10.7.3 í”„ë¡œí•„ ì •ë³´ ê°±ì‹  ê³¼ì •ì„ E2E í…ŒìŠ¤íŠ¸í•˜ê¸°
> ì„¸ë¶€ ë‚´ìš©ì€ ê±´ë“œë¦¬ì§€ ì•ŠëŠ” **ë¸”ë™ë°•ìŠ¤ í…ŒìŠ¤íŠ¸** í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ë³´ê¸°

```ts
import { expect, test } from "@playwright/test";
import { checkA11y, injectAxe } from "axe-playwright";
import { UserName } from "../prisma/fixtures/user";
import { assertUnauthorizedRedirect, login, url } from "./util";

test.describe("í”„ë¡œí•„ í¸ì§‘ í˜ì´ì§€", () => {
  const path = "/my/profile/edit";
  const userName: UserName = "User-MyProfileEdit";
  const newName = "NewName";

  test("í”„ë¡œí•„ì„ í¸ì§‘í•˜ë©´ í”„ë¡œí•„ì— ë°˜ì˜ëœë‹¤", async ({
    page,
  }) => {
    await page.goto(url(path));
    await login({ page, userName });
    // ì—¬ê¸°ì„œë¶€í„° í”„ë¡œí•„ í¸ì§‘í™”ë©´
    await expect(page).toHaveURL(url(path));
    await expect(page).toHaveTitle(`${userName}ë‹˜ì˜ í”„ë¡œí•„ í¸ì§‘`);
    await page.getByRole("textbox", { name: "ì‚¬ìš©ìëª…" }).fill(newName);
    await page.getByRole("button", { name: "í”„ë¡œí•„ ë³€ê²½í•˜ê¸°" }).click();
    await page.waitForURL(url("/my/posts"));
    // í˜ì´ì§€ ì œëª©ì— ë°©ê¸ˆ ì…ë ¥í•œ ì´ë¦„ì´ í¬í•¨ë¼ ìˆë‹¤.
    await expect(page).toHaveTitle(`${newName}ë‹˜ì˜ ê¸°ì‚¬ ëª©ë¡`);
    await expect(
      page.getByRole("region", { name: "í”„ë¡œí•„" })
    ).toContainText(newName);
    await expect(page.locator("[aria-label='ë¡œê·¸ì¸í•œ ì‚¬ìš©ì']")).toContainText(
      newName
    );
  });
});
```

<br />

---

<br />

## 10.8 Like ê¸°ëŠ¥ E2E í…ŒìŠ¤íŠ¸
> ê³µê°œëœ ê¸°ì‚¬ëŠ” ëˆ„êµ¬ë‚˜ ì—´ëŒí•  ìˆ˜ ìˆê³ , ì¸ê¸°ìˆœìœ¼ë¡œ ì •ë ¬í•˜ëŠ” ê¸°ëŠ¥ë„ ìˆë‹¤.
>
> ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë§Œ ê³µê°œëœ ê¸°ì‚¬ì— [Like] ë¥¼ ëˆ„ë¥¼ ìˆ˜ ìˆê³ , ìì‹ ì´ ì‘ì„±í•œ ê¸°ì‚¬ì—ëŠ” ëˆ„ë¥¼ ìˆ˜ ì—†ë‹¤.

1. ë‹¤ë¥¸ ì‚¬ëŒì´ ì‘ì„±í•œ ê¸°ì‚¬ì—ëŠ” [Like] ë¥¼ ëˆ„ë¥¼ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
2. ìì‹ ì˜ ê¸°ì‚¬ì—ëŠ” [Like] ë¥¼ ëˆ„ë¥¼ ìˆ˜ ì—†ì–´ì•¼ í•œë‹¤.

<br />

### 10.8.1 ë‹¤ë¥¸ ì‚¬ëŒì´ ì‘ì„±í•œ ê¸°ì‚¬ì—ëŠ” [Like] ë²„íŠ¼ì„ ëˆ„ë¥¼ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
> ì´ˆê¹ƒê°’ 90ê°œì˜ ë°ì´í„° ì¤‘ 66ê°œê°€ ê³µê°œëœ ê¸°ì‚¬, 24ê°œê°€ ë¹„ê³µê°œ ê¸°ì‚¬
>
> í…ŒìŠ¤íŠ¸ ì‚¬ìš©ìì¸ JPub ì€ 61~90 ê¸°ì‚¬ì˜ ì €ì
>
> ê¸°ì‚¬ ID ê°€ 1~60 ì¸ ê¸°ì‚¬ ì¤‘ ID ê°€ 10ì¸ ê¸°ì‚¬ì— ì ‘ì†í•˜ì—¬ [Like] ë¥¼ ëˆ„ë¥¼ ìˆ˜ ìˆëŠ”ì§€ í…ŒìŠ¤íŠ¸í•´ë³´ì.


```ts
  test("ë‹¤ë¥¸ ì‚¬ëŒì˜ ê¸°ì‚¬ì—ëŠ” Likeí•  ìˆ˜ ìˆë‹¤", async ({ page }) => {
    await page.goto(url("/login"));
    await login({ page, userName: "JPub" });
    await expect(page).toHaveURL(url("/"));
    // ì—¬ê¸°ì„œë¶€í„° IDê°€ 10ì¸ ê¸°ì‚¬ì˜ í˜ì´ì§€
    await page.goto(url("/posts/10"));
    const buttonLike = page.getByRole("button", { name: "Like" });
    const buttonText = page.getByTestId("likeStatus");
    // [Like] ë²„íŠ¼ì´ í™œì„±í™”ë˜ê³ , í˜„ì¬ Like ìˆ˜ëŠ” 0ì´ë‹¤.
    await expect(buttonLike).toBeEnabled();
    await expect(buttonLike).toHaveText("0");
    await expect(buttonText).toHaveText("Like");
    await buttonLike.click();
    // [Like]ë¥¼ í´ë¦­í•˜ë©´ ì¹´ìš´íŠ¸ê°€ 1 ì¦ê°€í•˜ê³ , ì´ë¯¸ [Like] ë²„íŠ¼ì„ ëˆ„ë¥¸ ìƒíƒœê°€ ëœë‹¤.
    await expect(buttonLike).toHaveText("1");
    await expect(buttonText).toHaveText("Liked");
  });
```

<br />

### 10.8.2 ìì‹ ì˜ ê¸°ì‚¬ì—ëŠ” [Like] ë²„íŠ¼ì„ ëˆ„ë¥¼ ìˆ˜ ì—†ì–´ì•¼ í•œë‹¤.
> ê¸°ì‚¬ ID ê°€ 90ì¸ ê¸°ì‚¬ëŠ” JPub ì´ ì‘ì„±í•œ ê¸°ì‚¬
>
> í•´ë‹¹ ê¸°ì‚¬ì— [Like] ë¥¼ ëˆ„ë¥¼ ìˆ˜ ìˆëŠ”ì§€ í…ŒìŠ¤íŠ¸í•´ë³´ì.


```ts
  test("ìì‹ ì˜ ê¸°ì‚¬ì—ëŠ” Likeí•  ìˆ˜ ì—†ë‹¤", async ({ page }) => {
    await page.goto(url("/login"));
    await login({ page, userName: "JPub" });
    await expect(page).toHaveURL(url("/"));
    // ì—¬ê¸°ì„œë¶€í„° IDê°€ 90ì¸ ê¸°ì‚¬ì˜ í˜ì´ì§€
    await page.goto(url("/posts/90"));
    const buttonLike = page.getByRole("button", { name: "Like" });
    const buttonText = page.getByTestId("likeStatus");
    // [Like] ë²„íŠ¼ì´ ë¹„í™œì„±í™”ë˜ê³ , Likeë¼ëŠ” ë¬¸ìë„ ì‚¬ë¼ì§„ë‹¤.
    await expect(buttonLike).toBeDisabled();
    await expect(buttonText).not.toHaveText("Like");
  });
```

<br />

---

<br />

## 10.9 ì‹ ê·œ ì‘ì„± í˜ì´ì§€ E2E í…ŒìŠ¤íŠ¸
> íˆ¬ê³  ê¸°ëŠ¥ì—ëŠ” CRUD ë¼ê³  ë¶€ë¥´ëŠ” ê¸°ëŠ¥ì´ ìˆëŠ”ë°, CRUD ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ëŠ” ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠëŠ”ì§€ ì„¸ì‹¬í•˜ê²Œ ì‚´í´ë³´ì•„ì•¼í•œë‹¤.

<br />

### 10.9.1 ì‹ ê·œ ì‘ì„± í˜ì´ì§€ì— ì ‘ê·¼í•´ ì½˜í…ì¸ ë¥¼ ì…ë ¥í•˜ëŠ” í•¨ìˆ˜
> ì½˜í…íŠ¸ ë‚´ìš©ì€ ì‹ ê²½ ì“°ì§€ ë§ê³  í•„ìˆ˜ ì…ë ¥ í•­ëª©ë§Œ ì±„ìš°ëŠ” ì¸í„°ë™ì…˜ í•¨ìˆ˜ë¥¼ ë§Œë“ ë‹¤.

- ì‘ì„±ìë¥¼ ì„ íƒí•  ìˆ˜ ìˆë„ë¡ ì¸ìˆ˜ë¡œ ì‘ì„±ìëª…ì„ ë°›ëŠ”ë‹¤.

```ts
export async function gotoAndFillPostContents({
  page,
  title,
  userName,
}: {
  page: Page;
  title: string;
  userName: UserName;
}) {
  await page.goto(url("/login"));
  await login({ page, userName });
  await expect(page).toHaveURL(url("/"));
  await page.goto(url("/my/posts/create"));
  await page.setInputFiles("data-testid=file", [
    "public/__mocks__/images/img01.jpg",
  ]);
  await page.waitForLoadState("networkidle", { timeout: 30000 });
  await page.getByRole("textbox", { name: "ì œëª©" }).fill(title); //ê¸°ì‚¬ í˜ì´ì§€ì˜ ì œëª©ì„ ì…ë ¥í•˜ì—¬ CRUD ì‘ì—…ì„ ìˆ˜í–‰í•  ê¸°ì‚¬ë¥¼ íŠ¹ì •í•  ìˆ˜ ìˆê²Œ ë§Œë“ ë‹¤.
}
```

<br />

### 10.9.2 ì‹ ê·œ ê¸°ì‚¬ë¥¼ ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•˜ëŠ” í•¨ìˆ˜
> ì‹ ê·œ ê¸°ì‚¬ë¥¼ ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•˜ëŠ” ì‘ì—…ë„ ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰ì´ í•„ìš”í•œ ì¸í„°ë™ì…˜

```ts
export async function gotoAndCreatePostAsDraft({
  page,
  title,
  userName,
}: {
  page: Page;
  title: string;
  userName: UserName;
}) {
  await gotoAndFillPostContents({ page, title, userName });
  await page.getByRole("button", { name: "ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥" }).click();
  await page.waitForNavigation();
  await expect(page).toHaveTitle(title);
}
```

<br />

### 10.9.3 ì‹ ê·œ ê¸°ì‚¬ë¥¼ ê³µê°œí•˜ëŠ” í•¨ìˆ˜
> ì‹ ê·œ ê¸°ì‚¬ë¥¼ ê³µê°œí•˜ëŠ” í•¨ìˆ˜ë„ ì—¬ëŸ¬ ì°¨ë¡€ ì‹¤í–‰ì´ í•„ìš”í•œ ì¸í„°ë™ì…˜

```ts
export async function gotoAndCreatePostAsPublish({
  page,
  title,
  userName,
}: {
  page: Page;
  title: string;
  userName: UserName;
}) {
  await gotoAndFillPostContents({ page, title, userName });
  await page.getByText("ê³µê°œ ì—¬ë¶€").click();
  await page.getByRole("button", { name: "ê³µê°œí•˜ê¸°" }).click();
  await page.getByRole("button", { name: "ë„¤" }).click(); //ì„ì‹œ ì €ì¥ê³¼ ë‹¤ë¥´ê²Œ ê³µê°œí•˜ê¸° ì „ì— í™•ì¸ì°½ ë„ìš°ê¸°
  await page.waitForNavigation();
  await expect(page).toHaveTitle(title);
}
```

<br />

### 10.9.4 ì§€ê¸ˆê¹Œì§€ ë§Œë“  í•¨ìˆ˜ë“¤ì„ E2E í…ŒìŠ¤íŠ¸ì— í™œìš©í•˜ê¸°
> ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•˜ëŠ” í•¨ìˆ˜, ê³µê°œ í•¨ìˆ˜ë¥¼ í™œìš©í•´ ì‹ ê·œ ì‘ì„± í˜ì´ì§€ì˜ E2E í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•´ë³´ì.

```ts
import { test } from "@playwright/test";
import { checkA11y, injectAxe } from "axe-playwright";
import { UserName } from "../prisma/fixtures/user";
import {
  gotoAndCreatePostAsDraft,
  gotoAndCreatePostAsPublish,
} from "./postUtil";

test.describe("ì‹ ê·œ ê¸°ì‚¬ í˜ì´ì§€", () => {
  const path = "/my/posts/create";
  const userName: UserName = "JPub";

  test("ì‹ ê·œ ê¸°ì‚¬ë¥¼ ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•  ìˆ˜ ìˆë‹¤", async ({ page }) => {
    const title = "ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•˜ê¸° í…ŒìŠ¤íŠ¸";
    await gotoAndCreatePostAsDraft({ page, title, userName });
  });

  test("ì‹ ê·œ ê¸°ì‚¬ë¥¼ ê³µê°œí•  ìˆ˜ ìˆë‹¤", async ({ page }) => {
    const title = "ê³µê°œí•˜ê¸° í…ŒìŠ¤íŠ¸";
    await gotoAndCreatePostAsPublish({ page, title, userName });
  });
});
```

<br />

---

<br />

## 10.10 ê¸°ì‚¬ í¸ì§‘ í˜ì´ì§€ E2E í…ŒìŠ¤íŠ¸
> ì‘ì„±ëœ ê¸°ì‚¬ëŠ” ê³µê°œ ì—¬ë¶€ì™€ ë¬´ê´€í•˜ê²Œ ì½˜í…ì¸ ë¥¼ í¸ì§‘í•˜ê³  ê³µê°œ ì—¬ë¶€ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
>
> ê¸°ì‚¬ë¥¼ í¸ì§‘í–ˆì„ ë•Œ ê¸°ì‚¬ ëª©ë¡ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ + ê¸°ì‚¬ë¥¼ ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì— ëŒ€í•œ E2E xptmxmfmf dkfdkqhwk.

<br />

### 10.10.1 ìƒˆë¡œ ì¶”ê°€í•  ê³µí†µ í•¨ìˆ˜
> ì‘ì„±ëœ ê¸°ì‚¬ í˜ì´ì§€ë¡œ ì´ë™ í›„ì— í¸ì§‘ í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ” ì¸í„°ë™ì…˜ì„ í•¨ìˆ˜ë¡œ ë§Œë“¤ì.

```ts
export async function gotoEditPostPage({
  page,
  title,
}: {
  page: Page;
  title: string;
}) {
  await page.getByRole("link", { name: "í¸ì§‘í•˜ê¸°" }).click();
  await page.waitForNavigation();
  await expect(page).toHaveTitle(`ê¸°ì‚¬ í¸ì§‘ | ${title}`);
}
```

<br />

### 10.10.2 ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•œ ê¸°ì‚¬ í¸ì§‘í•˜ê¸°
> ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•œ ê¸°ì‚¬ë¥¼ í¸ì§‘í•´ ë‚´ìš©ì´ ê°±ì‹ ë˜ëŠ”ì§€ ê²€ì¦í•˜ëŠ” E2E í…ŒìŠ¤íŠ¸

```ts
  test("ë¹„ê³µê°œ ê¸°ì‚¬ë¥¼ í¸ì§‘í•  ìˆ˜ ìˆë‹¤", async ({ page }) => {
    const title = "ë¹„ê³µê°œ í¸ì§‘ í…ŒìŠ¤íŠ¸";
    const newTitle = "ë¹„ê³µê°œ í¸ì§‘ í…ŒìŠ¤íŠ¸ ê°±ì‹  ì™„ë£Œ";
    await gotoAndCreatePostAsDraft({ page, title, userName });
    await gotoEditPostPage({ page, title });
    await page.getByRole("textbox", { name: "ì œëª©" }).fill(newTitle);
    await page.getByRole("button", { name: "ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥" }).click(); //ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥
    await page.waitForNavigation();
    await expect(page).toHaveTitle(newTitle); //ì œëª©ì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ í™•ì¸
  });
```

<br />

### 10.10.3 ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•œ ê¸°ì‚¬ ê³µê°œí•˜ê¸°
> ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•œ ê¸°ì‚¬ë¥¼ í¸ì§‘ í›„ì— ê³µê°œ ìƒíƒœë¡œ ë³€ê²½í•  ìˆ˜ ìˆëŠ”ì§€ ê²€ì¦í•˜ëŠ” E2E í…ŒìŠ¤íŠ¸

```ts
  test("ë¹„ê³µê°œ ê¸°ì‚¬ë¥¼ ê³µê°œí•  ìˆ˜ ìˆë‹¤", async ({ page }) => {
    const title = "ë¹„ê³µê°œ ê¸°ì‚¬ ê³µê°œ í…ŒìŠ¤íŠ¸";
    await gotoAndCreatePostAsDraft({ page, title, userName });
    await gotoEditPostPage({ page, title });
    await page.getByText("ê³µê°œ ì—¬ë¶€").click(); //ê³µê°œ ì—¬ë¶€ ë³€ê²½í•˜ê¸°
    await page.getByRole("button", { name: "ê³µê°œí•˜ê¸°" }).click();
    await page.getByRole("button", { name: "ë„¤" }).click(); //ê³µê°œí• ì§€ í™•ì¸í•˜ëŠ” ëŒ€í™”ì°½ì—ì„œ [ë„¤] í´ë¦­í•˜ê¸°
    await page.waitForNavigation();
    await expect(page).toHaveTitle(title);
  });
```

<br />

### 10.10.4 ê³µê°œëœ ê¸°ì‚¬ ë¹„ê³µê°œ ì²˜ë¦¬í•˜ê¸°
> ê³µê°œëœ ê¸°ì‚¬ë¥¼ í¸ì§‘í•˜ê³  ë¹„ê³µê°œ ìƒíƒœë¡œ ë³€ê²½í•  ìˆ˜ ìˆëŠ”ì§€ ê²€ì¦í•˜ëŠ” E2E í…ŒìŠ¤íŠ¸

```ts
  test("ê³µê°œëœ ê¸°ì‚¬ë¥¼ ë¹„ê³µê°œí•  ìˆ˜ ìˆë‹¤", async ({ page }) => {
    const title = "ê¸°ì‚¬ ë¹„ê³µê°œ í…ŒìŠ¤íŠ¸";
    await gotoAndCreatePostAsPublish({ page, title, userName }); //ê³µê°œ ìƒíƒœë¡œ ì €ì¥
    await gotoEditPostPage({ page, title });
    await page.getByText("ê³µê°œ ì—¬ë¶€").click(); //ê³µê°œ ì—¬ë¶€ ë³€ê²½
    await page.getByRole("button", { name: "ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥" }).click(); //ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥
    await page.waitForNavigation();
    await expect(page).toHaveTitle(title);
  });
```

<br />

### 10.10.5 ê³µê°œëœ ê¸°ì‚¬ ì‚­ì œí•˜ê¸°
> ê³µê°œëœ ê¸°ì‚¬ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆëŠ”ì§€ ê²€ì¦í•˜ëŠ” E2E í…ŒìŠ¤íŠ¸

```ts
  test("ê³µê°œëœ ê¸°ì‚¬ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆë‹¤", async ({ page }) => {
    const title = "ê¸°ì‚¬ ì‚­ì œ í…ŒìŠ¤íŠ¸";
    await gotoAndCreatePostAsPublish({ page, title, userName });
    await gotoEditPostPage({ page, title });
    await page.getByRole("button", { name: "ì‚­ì œí•˜ê¸°" }).click(); //[ì‚­ì œí•˜ê¸°] ë²„íŠ¼ì„ í´ë¦­
    await page.getByRole("button", { name: "ë„¤" }).click(); //ì‚­ì œ í™•ì¸ì°½ì—ì„œ [ë„¤] í´ë¦­í•˜ê¸°
    await page.waitForNavigation();
    await expect(page).toHaveTitle(`${userName}ë‹˜ì˜ ê¸°ì‚¬ ëª©ë¡`);
  });
```

<br />

---

<br />

## 10.11 ê²Œì¬ëœ ê¸°ì‚¬ ëª©ë¡ í˜ì´ì§€ E2E í…ŒìŠ¤íŠ¸
> ì¸í„°ë™ì…˜ì˜ í›„ì† ì²˜ë¦¬ë¡œ ì‹ ê·œ ê¸°ì‚¬ê°€ ì‘ì„±ë˜ë©´ ê¸°ì‚¬ ëª©ë¡ì— ì–´ë–¤ ì˜í–¥ì„ ì£¼ëŠ”ì§€ì— ëŒ€í•œ E2E í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ì.
>
> ê¸°ì‚¬ ëª©ë¡ = ë©”ì¸ í˜ì´ì§€ / ë§ˆì´ í˜ì´ì§€ (ë‘ ê³³ì— ìˆë‹¤.)
>
> ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•œ ê¸°ì‚¬ëŠ” ì‘ì„±ì ì™¸ì—ëŠ” ì—´ëŒì´ ë¶ˆê°€í•˜ê¸° ë•Œë¬¸ì— ë©”ì¸ í˜ì´ì§€ì˜ ê¸°ì‚¬ ëª©ë¡ì—ëŠ” ê²Œì¬ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤.

<br />

### 10.11.1 ì‘ì„±í•œ ê¸°ì‚¬ê°€ ëª©ë¡ì— ì¶”ê°€ëëŠ”ì§€ ê²€ì¦í•˜ê¸°
> ë§ˆì´ í˜ì´ì§€ì˜ ê¸°ì‚¬ ëª©ë¡ì— ì‹ ê·œ ê¸°ì‚¬ê°€ ì¶”ê°€ëëŠ”ì§€ ê²€ì¦í•˜ëŠ” E2E í…ŒìŠ¤íŠ¸

```ts
import { expect, test } from "@playwright/test";
import { checkA11y, injectAxe } from "axe-playwright";
import { UserName } from "../prisma/fixtures/user";
import {
  gotoAndCreatePostAsDraft,
  gotoAndCreatePostAsPublish,
} from "./postUtil";
import { assertUnauthorizedRedirect, login, url } from "./util";

test.describe("ê²Œì¬ëœ ê¸°ì‚¬ ëª©ë¡ í˜ì´ì§€", () => {
  const path = "/my/posts";
  const userName: UserName = "JPub";

  test("ì‹ ê·œ ê¸°ì‚¬ë¥¼ ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•˜ë©´ ê²Œì¬ëœ ê¸°ì‚¬ ëª©ë¡ì— ê¸°ì‚¬ê°€ ì¶”ê°€ëœë‹¤", async ({
    page,
  }) => {
    const title = "ë¹„ê³µê°œë¡œ ì €ì¥ëœ ê¸°ì‚¬ ëª©ë¡ í…ŒìŠ¤íŠ¸";
    await gotoAndCreatePostAsDraft({ page, title, userName });
    await page.goto(url(path));
    await expect(page.getByText(title)).toBeVisible();
  });

  test("ì‹ ê·œ ê¸°ì‚¬ë¥¼ ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•˜ë©´ ê²Œì¬ëœ ê¸°ì‚¬ ëª©ë¡ì— ê¸°ì‚¬ê°€ ì¶”ê°€ëœë‹¤", async ({
    page,
  }) => {
    const title = "ê³µê°œ ìƒíƒœë¡œ ì €ì¥ëœ ê¸°ì‚¬ ëª©ë¡ í…ŒìŠ¤íŠ¸";
    await gotoAndCreatePostAsPublish({ page, title, userName });
    await page.goto(url(path));
    await expect(page.getByText(title)).toBeVisible();
  });
});
```

<br />

### 10.11.2 ê³µê°œëœ ê¸°ì‚¬ê°€ ë©”ì¸ í˜ì´ì§€ì— ì¶”ê°€ëëŠ”ì§€ ê²€ì¦í•˜ê¸°
> ë©”ì¸ í˜ì´ì§€ì˜ ê¸°ì‚¬ ëª©ë¡ì— ì‹ ê·œ ê¸°ì‚¬ê°€ ì¶”ê°€ëëŠ”ì§€ ê²€ì¦í•˜ëŠ” E2E í…ŒìŠ¤íŠ¸

```ts
import { expect, test } from "@playwright/test";
import { checkA11y, injectAxe } from "axe-playwright";
import { UserName } from "../prisma/fixtures/user";
import { gotoAndCreatePostAsPublish, gotoEditPostPage } from "./postUtil";
import { login, url } from "./util";

test.describe("ë©”ì¸ í˜ì´ì§€", () => {
  const path = "/";
  const userName: UserName = "JPub";

  test("ì‹ ê·œ ê¸°ì‚¬ë¥¼ ê³µê°œ ìƒíƒœë¡œ ì €ì¥í•˜ë©´ ìµœì‹  ê¸°ì‚¬ ëª©ë¡ì— í‘œì‹œëœë‹¤", async ({
    page,
  }) => {
    const title = "ê³µê°œ ì €ì¥ í›„ ìµœì‹  ê¸°ì‚¬ ëª©ë¡ í…ŒìŠ¤íŠ¸";
    await gotoAndCreatePostAsPublish({ page, title, userName });
    await page.goto(url(path));
    await expect(page.getByText(title)).toBeVisible();
  });

  test("ê³µê°œëœ ê¸°ì‚¬ë¥¼ ë¹„ê³µê°œí•˜ë©´ ìµœì‹  ê¸°ì‚¬ ëª©ë¡ì— í‘œì‹œë˜ì§€ ì•ŠëŠ”ë‹¤", async ({
    page,
  }) => {
    const title = "ë¹„ê³µê°œ í›„ ìµœì‹  ê¸°ì‚¬ ëª©ë¡ í…ŒìŠ¤íŠ¸";
    await gotoAndCreatePostAsPublish({ page, title, userName });
    await gotoEditPostPage({ page, title });
    await page.getByText("ê³µê°œ ì—¬ë¶€").click();
    await page.getByRole("button", { name: "ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥" }).click();
    await page.waitForNavigation();
    await expect(page).toHaveTitle(title);
    await page.goto(url(path));
    await expect(page.getByText(title)).not.toBeVisible();
  });
});
```

<br />

---

<br />

## 10.12 ë¶ˆì•ˆì •í•œ í…ŒìŠ¤íŠ¸ ëŒ€ì²˜ ë°©ë²•
> E2E í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ë¥¼ í†µí•œ í…ŒìŠ¤íŠ¸ëŠ” ì•ˆì •ì ì´ì§€ ì•Šë‹¤?
>
> **ë¶ˆì•ˆì •í•œ í…ŒìŠ¤íŠ¸** : ë„¤íŠ¸ì›Œí¬ ì§€ì—°, ë©”ëª¨ë¦¬ ë¶€ì¡±ì— ì˜í•œ ì„œë²„ ì‘ë‹µ ì§€ì—° ë“± ë‹¤ì–‘í•œ ì›ì¸ìœ¼ë¡œ ë°œìƒ
>
> ë¶ˆì•ˆì •í•œ í…ŒìŠ¤íŠ¸ì— ì§ë©´í–ˆì„ ë•Œ ëª‡ê°€ì§€ ëŒ€ì²˜ ë°©ë²•ì„ ì‚´í´ë³´ì.

<br />

### 10.12.1 ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ë°ì´í„°ë² ì´ìŠ¤ ì¬ì„¤ì •í•˜ê¸°
**ë°ì´í„°ë² ì´ìŠ¤** ë¥¼ ì‚¬ìš©í•˜ëŠ” E2E í…ŒìŠ¤íŠ¸ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ ë°ì´í„°ê°€ ë³€ê²½

ì¼ê´€ì„±ìˆëŠ” ê²°ê³¼ë¥¼ ì–»ìœ¼ë ¤ë©´ í…ŒìŠ¤íŠ¸ ì‹œì‘ ì‹œì  ìƒíƒœëŠ” í•­ìƒ ë™ì¼í•´ì•¼ í•˜ë¯€ë¡œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ì‹œë“œ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì´ˆê¹ƒê°’ì„ ì¬ì„¤ì •í•œë‹¤.

<br />

### 10.12.2 í…ŒìŠ¤íŠ¸ë§ˆë‹¤ ì‚¬ìš©ìë¥¼ ìƒˆë¡œ ë§Œë“¤ê¸°
ê° í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ìƒì„±í•œ ì‚¬ìš©ìë¥¼ ì‚¬ìš©í•˜ê³ , í…ŒìŠ¤íŠ¸ê°€ ëë‚˜ë©´ í…ŒìŠ¤íŠ¸ìš© ì‚¬ìš©ìëŠ” ì‚­ì œí•˜ê¸°.

<br />

### 10.12.3 í…ŒìŠ¤íŠ¸ ê°„ ë¦¬ì†ŒìŠ¤ê°€ ê²½í•©í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ê¸°
CRUD ê¸°ëŠ¥ì˜ í…ŒìŠ¤íŠ¸ì²˜ëŸ¼ ë§¤ë²ˆ ìƒˆë¡œìš´ ë¦¬ì†ŒìŠ¤ë¥¼ ì‘ì„±í•˜ë„ë¡ í•˜ê¸°.

í”Œë ˆì´ë¼ì´íŠ¸ í…ŒìŠ¤íŠ¸ëŠ” ë³‘ë ¬ì²˜ë¦¬ë˜ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ìˆœì„œë¥¼ ë³´ì¥í•  ìˆ˜ ì—†ìŒ!!! (ë¦¬ì†ŒìŠ¤ ê²½í•©ì´ ë°œìƒí•˜ê³  ìˆëŠ”ì§€ ê²€í† í•´ì•¼ í•œë‹¤!)

<br />

### 10.12.4 ë¹Œë“œí•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸°
E2E í…ŒìŠ¤íŠ¸ëŠ” ê°œë°œ ì„œë²„ì—ì„œ ì‹¤í–‰í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•´ì•¼ í•œë‹¤.

ë¹Œë“œí•œ Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ê°œë°œì„œë²„ì™€ ë‹¤ë¥´ê²Œ ë™ì‘í•˜ê³ , ì‘ë‹µ ì†ë„ë„ ëŠë ¤ì„œ ë¶ˆì•ˆì •í•œ í…ŒìŠ¤íŠ¸ì˜ ì›ì¸ì´ ëœë‹¤!

<br />

### 10.12.5 ë¹„ë™ê¸° ì²˜ë¦¬ ëŒ€ê¸°í•˜ê¸°
ì‹œê°„ì´ ê±¸ë¦¬ëŠ” ì‘ì—…ì€ ë¹„ë™ê¸° ì²˜ë¦¬ ì‘ë‹µì„ ëŒ€ê¸°í•´ì•¼ í•œë‹¤.

ë¬¸ì œì—†ì´ ì¸í„°ë™ì…˜ì´ í• ë‹¹ëìŒì—ë„ í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•˜ë©´ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ì œëŒ€ë¡œ ëŒ€ê¸°í•˜ëŠ”ì§€ í™•ì¸í•˜ì.

<br />

### 10.12.6 --debug ë¡œ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì›ì¸ ì¡°ì‚¬í•˜ê¸°
í”Œë ˆì´ë¼ì´íŠ¸ ì‹¤í–‰í•  ë•Œ --debug ì˜µì…˜ì„ ë¶™ì—¬ ë””ë²„ê±°ë¥¼ ì‹¤í–‰ í›„ í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•˜ëŠ” ì›ì¸ì„ ë¹ ë¥´ê²Œ ì°¾ì.

<br />

### 10.12.7 CI í™˜ê²½ê³¼ CPU ì½”ì–´ ìˆ˜ ë§ì¶”ê¸°
ë¡œì»¬ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í–ˆì„ ë•ŒëŠ” ëª¨ë‘ í†µê³¼í•˜ì§€ë§Œ CI í™˜ê²½ì—ì„œ ì‹¤íŒ¨í•˜ê¸°ë„ í•œë‹¤.

í”Œë ˆì´ë¼ì´íŠ¸ë‚˜ ì œìŠ¤íŠ¸ëŠ” ì½”ì–´ ìˆ˜ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ì‹¤í–‰ í™˜ê²½ì—ì„œ ì‹¤í–‰ ê°€ëŠ¥í•œ ë§Œí¼ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ë¥¼ ë³‘ë ¬ì²˜ë¦¬ í•œë‹¤.

CPU ì½”ì–´ ìˆ˜ê°€ ë³€ë™ë˜ì§€ ì•Šë„ë¡ ê³ ì •í•˜ëŠ” ì„¤ì •ì„ ì¶”ê°€í•˜ê±°ë‚˜, ëŒ€ê¸° ì‹œê°„ì˜ ìƒí•œì„ ëŠ˜ë ¤ë³´ì.

<br />

### 10.12.8 í…ŒìŠ¤íŠ¸ ë²”ìœ„ ìµœì í™”
E2E í…ŒìŠ¤íŠ¸ë¡œ ê²€ì¦í•˜ëŠ” ê²ƒì´ ì ì ˆí•œì§€ ì‚´í´ë´ì•¼ í•œë‹¤.

ê²€ì¦ ë‚´ìš©ì— ë§ëŠ” ìµœì ì˜ í…ŒìŠ¤íŠ¸ ë²”ìœ„ë¥¼ ì°¾ì•„ì•¼ ë¶ˆì•ˆì •í•œ í…ŒìŠ¤íŠ¸ê°€ ìƒê¸¸ ê°€ëŠ¥ì„±ì´ ë‚®ì•„ì§„ë‹¤.
