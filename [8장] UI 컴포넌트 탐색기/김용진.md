# [8ì¥] UI ì»´í¬ë„ŒíŠ¸ íƒìƒ‰ê¸°

---

## 8.1 ìŠ¤í† ë¦¬ë¶ ê¸°ì´ˆ
UI ì»´í¬ë„ŒíŠ¸ íƒìƒ‰ê¸°ëŠ” êµ¬í˜„ëœ UI ì»´í¬ë„ŒíŠ¸ë¥¼ ì‰½ê²Œ ê³µìœ í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” í˜‘ì—… ë„êµ¬ë‹¤.
ìµœê·¼ì—ëŠ” UI ì»´í¬ë„ŒíŠ¸ íƒìƒ‰ê¸°ë¥¼ í˜‘ì—… ë„êµ¬ê°€ ì•„ë‹Œ í…ŒìŠ¤íŠ¸ì— í™œìš©í•˜ëŠ” ì‚¬ë¡€ê°€ ë§ì•„ì¡Œë‹¤.

ê¸°ì¡´ì˜ í”„ëŸ°íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸ëŠ” ë‹¤ìŒì˜ ë‘ ê°€ì§€ í…ŒìŠ¤íŠ¸ë¥¼ ì˜ë¯¸í–ˆë‹¤.

- `jsdom`ì„ ì‚¬ìš©í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë° í†µí•©í…ŒìŠ¤íŠ¸
- ë¸Œë¼ìš°ì €ë¥¼ ì‚¬ìš©í•œ E2E í…ŒìŠ¤íŠ¸

ìŠ¤í† ë¦¬ë¶ì˜ UIì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ëŠ” ì´ ë‘ ê°€ì§€ í…ŒìŠ¤íŠ¸ì˜ ì¤‘ê°„ì— ìœ„ì¹˜í•œ í…ŒìŠ¤íŠ¸ë‹¤.
![image](https://github.com/user-attachments/assets/e99d101e-ac17-4b37-85c7-16d917615d49)

### 8.1.1 ìŠ¤í† ë¦¬ë¶ ì„¤ì¹˜
ìŠ¤í† ë¦¬ë¶ ì„¤ì¹˜
```bash
$ npx storybook init
```

```bash
  storybook@8.2.9
Ok to proceed? (y)
```

ìŠ¤í† ë¦¬ë¶ ì‹¤í–‰ http://localhost:6006/ ì— ì‹¤í–‰ëœë‹¤.
```bash
$ npm run storybook
```

### 8.1.2 ìŠ¤í† ë¦¬ ë“±ë¡
ìŠ¤í† ë¦¬ë¥¼ ë“±ë¡í•˜ë ¤ë©´ í”„ë¡œì íŠ¸ì— ìŠ¤í† ë¦¬ íŒŒì¼ì„ ì¶”ê°€í•´ì•¼ í•œë‹¤.<br>
ì˜ˆì œ ì½”ë“œ `Button.jsx`ë¼ëŠ” UI ì»´í¬ë„ŒíŠ¸ë¥¼ ìŠ¤í† ë¦¬ ë“±ë¡ì„ ìœ„í•´ í•„ìš”í•œ ìŠ¤í† ë¦¬ íŒŒì¼ Button.stories.jsx ë‹¤.
```tsx
import { Button } from "./Button";

export default {
  title: "Example/Button",
  component: Button,
};
```

UI ì»´í¬ë„ŒíŠ¸ Propsì˜ ì¡°í•©ìœ¼ë¡œ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ê³¼ ì‘ë™ì„ ì œê³µí•  ìˆ˜ ìˆë‹¤.
Button ë¬¸ìì—´ì„ í‘œì‹œí•  ë•ŒëŠ” label ì´ë¼ëŠ” Propsë¥¼ ì§€ì •í•œë‹¤. ( ìŠ¤í† ë¦¬ë¶ì—ì„œëŠ” Propsì— í•´ë‹¹í•˜ëŠ” ë³€ìˆ˜ëª…ì´ args ì´ë‹¤.)
```tsx
export const Default = {
  args: {
    label: "Button"
  }
};
```

sizeê°€ ë‹¤ë¥¸ `export` ê°ì²´ ì´ë¦„ìœ¼ë¡œ ê°œë³„ ìŠ¤í† ë¦¬ ë“±ë¡ 
```tsx
export const Large = {
  args: {
    size: "large"
    label: "Button"
  }
};

export const Small = {
  args: {
    size: "small"
    label: "Button"
  }
};
```

### 8.1.3 3ë‹¨ê³„ ê¹Šì€ ë³‘í•©
ëª¨ë“  ìŠ¤í† ë¦¬ì—ëŠ” 'Global', Component', 'Story' ì„¸ ë‹¨ê³„ì˜ ì„¤ì •ì´ ê¹Šì€ ë³‘í•© ë°©ì‹ìœ¼ë¡œ ì ìš©ëœë‹¤.

- Global ë‹¨ê³„: ëª¨ë“  ìŠ¤í† ë¦¬ì— ì ìš©í•  ì„¤ì • (.storybook/preview.js)
- Component ë‹¨ê³„: ìŠ¤í† ë¦¬ íŒŒì¼ì— ì ìš©í•  ì„¤ì • (export default)
- Story ë‹¨ê³„: ê°œë³„ ìŠ¤í† ë¦¬ì— ì ìš©í•  ì„¤ì • (export const)


## 8.2 ìŠ¤í† ë¦¬ë¶ í•„ìˆ˜ ì• ë“œì˜¨
ìŠ¤í† ë¦¬ë¶ì€ ì• ë“œì˜¨ìœ¼ë¡œ í•„ìš”í•œ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. ì„¤ì¹˜ì‹œ ê¸°ë³¸ì ìœ¼ë¡œ ì¶”ê°€ë˜ëŠ” `@storybook/addon-essentials`ì€ í•„ìˆ˜ ì• ë“œì˜¨ ì´ë‹¤.

### 8.2.1 Controlsë¥¼ í™œìš©í•œ ë””ë²„ê¹…
UI ì»´í¬ë„ŒíŠ¸ëŠ” Propsì— ì „ë‹¬ëœ ê°’ì— ë”°ë¼ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ê³¼ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. ìŠ¤í† ë¦¬ë¶ íƒìƒ‰ê¸°ì—ì„œëŠ” `Props`ë¥¼ ë³€ê²½í•´ ì»´í¬ë„ŒíŠ¸ê°€ ì–´ë–»ê²Œ í‘œì‹œë˜ëŠ”ì§€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë””ë²„ê¹…í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ **Controls**ë¼ê³  í•œë‹¤.

`Props`(`children`, `theme`, `variant`, `disabled`)ë¥¼ ë³€ê²½í•˜ë©´ UI ì»´í¬ë„ŒíŠ¸ê°€ ì–´ë–»ê²Œ ë³€í™”í•˜ëŠ”ì§€ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
![image](https://github.com/user-attachments/assets/548ffa1d-2b82-49e4-ab98-ebb491fcb9e5)

`@stroybook/addon-controls`ë¼ëŠ” ì• ë“œì˜¨ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ë©°, ìŠ¤ë„ë¦¬ë¶ì„ ì„¤ì¹˜í•  ë•Œ ì ìš©ë˜ëŠ” `@storybook/addon-essentials`ì— í¬í•¨ë˜ì–´ ìˆë‹¤.

### 8.2.2 Actionsë¥¼ í™œìš©í•œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ê²€ì¦
UI ì»´í¬ë„ŒíŠ¸ëŠ” ë‚´ë¶€ ë¡œì§ì„ ì²˜ë¦¬í•  ë•Œ `Props`ë¡œ ì „ë‹¬ë°›ì€ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ê¸°ë„ í•œë‹¤. ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ ì–´ë–»ê²Œ í˜¸ì¶œëëŠ”ì§€ ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ëŠ” ê¸°ëŠ¥ì´ **Actions**ì´ë©°, `@stroybook/addon-actions`íŒ¨í‚¤ì§€ì—ì„œ ì œê³µí•œë‹¤. `@storybook/addon-essentials`ì— í¬í•¨ë˜ì–´ ìˆë‹¤.

titleë¥¼ ì…ë ¥í•˜ì§€ ì•Šê³ , ì €ì¥í•˜ë ¤ê³  í•˜ë©´ `onInvalid` í˜¸ì¶œëê³  ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
![image](https://github.com/user-attachments/assets/c24a1c83-3582-4768-969d-a9f22ceb7de6)


Global ë‹¨ê³„ ì„¤ì •ìœ¼ë¡œ `on`ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ëŠ” ìë™ì ìœ¼ë¡œ Actions íŒ¨ë„ì— ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ê²Œ ëœë‹¤.
í•¸ë“¤ëŸ¬ ì´ë¦„ì´ ë‹¤ë¥¸ ê²½ìš° ì •ê·œí‘œí˜„ì‹ì„ ìˆ˜ì •í•´ì•¼ í•œë‹¤.
```tsx
export const parameters = {
  actions: { argTypesRegex: "^on[A-Z].*" },
};
```

### 8.2.3 ë°˜ì‘í˜• ëŒ€ì‘ì„ ìœ„í•œ ë·°í¬íŠ¸ ì„¤ì •
ë°˜ì‘í˜•ìœ¼ë¡œ êµ¬í˜„í•œ UI ì»´í¬ë„ŒíŠ¸ëŠ” í™”ë©´ í¬ê¸°ë³„ë¡œ ìŠ¤í† ë¦¬ë¥¼ ë“±ë¡í•  ìˆ˜ ìˆë‹¤. `@stroybook/addon-viewport`íŒ¨í‚¤ì§€ì—ì„œ ì§€ì›í•œë‹¤.

![image](https://github.com/user-attachments/assets/5cdd27d2-222f-4051-b93e-a7f0d34199d1)

ë ˆì´ì•„ì›ƒìœ¼ë¡œ ìŠ¤í† ë¦¬ë¥¼ ë“±ë¡í•˜ë ¤ë©´ `parameters.viewport`ë¥¼ ì„¤ì •í•´ì•¼í•œë‹¤. SP(ìŠ¤ë§ˆíŠ¸í°) `SPStroy`ë¼ëŠ” ê³µí†µëœ ì„¤ì •ì„ ë§Œë“¤ì—ˆë‹¤.
```tsx
export const SPStory = {
  parameters: {
    viewport: {
      viewports: INITIAL_VIEWPORTS,
      defaultViewport: "iphone6",
    },
    screenshot: {  // ì‹œê°ì  íšŒê¸° í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì„¤ì •
      viewport: {
        width: 375,
        height: 667,
        deviceScaleFactor: 1,
      },
      fullPage: false,
    },
  },
};

// ìŠ¤ë§ˆíŠ¸í° ë¡œê·¸ì¸ í™”ë©´ 
export const SPLoggedIn: Story = {
  parameters: {
    ...SPStory.parameters,
  },
}

// PC ë¡œê·¸ì¸ í™”ë©´ 
export const PCLoggedIn: Story = {
  parameters: {
    ...PCStory.parameters,
  },
}
```

## 8.3 Context APIì— ì˜ì¡´í•˜ëŠ” ìŠ¤í† ë¦¬ ë“±ë¡
Context APIì— ì˜ì¡´í•˜ëŠ” ìŠ¤í† ë¦¬ì—ëŠ” **ë°ì»¤ë ˆì´í„°**ë¥¼ í™œìš©í•˜ëŠ” ê²ƒì´ í¸ë¦¬í•˜ë‹¤. ì´ˆê¹ƒê°’ì„ ì£¼ì…í•  ìˆ˜ ìˆë„ë¡ Providerë¥¼ ë§Œë“¤ë©´ Contextì˜ ìƒíƒœì— ì˜ì¡´í•˜ëŠ” UIë¥¼ ê°„ë‹¨í•˜ê²Œ ì¬í˜„í•  ìˆ˜ ìˆë‹¤.

### 8.3.1 ìŠ¤í† ë¦¬ë¶ì˜ ë°ì»¤ë ˆì´í„°
ë°ì»¤ë ˆì´í„°ëŠ” ê° ìŠ¤í† ë¦¬ì˜ ë Œë”ë§ í•¨ìˆ˜ì— ì ìš©í•  **ë˜í¼**ë‹¤. UI ì»´í¬ë„ŒíŠ¸ ë°”ê¹¥ìª½ì— ì—¬ë°±ì„ ë§Œë“¤ê³  ì‹¶ë‹¤ë©´ ë°ì»¤ë ˆì´í„°ë¥¼ `decorators` ë°°ì—´ì— ì¶”ê°€í•œë‹¤.
```tsx
import { ChildComponent } from "./";

export default {
  title: "ChildComponent",
  component: ChildComponent,
  decorators: [
    (Story) => (
      <div style={{ padding: "60px" }}>
        <Stroy />
      </div>
    ),
  ],
};
```

### 8.3.2 Providerë¥¼ ì†Œìœ í•œ í…Œì»¤ë ˆì´í„°
ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì •ë³´ê°€ ìˆëŠ” `Provider`ë¥¼ ë°ì»¤ë ˆì´í„°ê°€ ì†Œìœ í–ˆë‹¤ë©´, `Context`ì˜ `Provider`ì— ì˜ì¡´í•˜ëŠ” UI ì»´í¬ë„ŒíŠ¸ì˜ ìŠ¤í† ë¦¬ì—ì„œë„ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ í‘œì‹œí•  ìˆ˜ ìˆë‹¤.<br>
ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í•„ìš”í•œ `Provider`ë¼ë©´ ì‹¤ì œ êµ¬í˜„ ì½”ë“œì™€ ë˜‘ê°™ì´ ì‚¬ìš©í•´ë„ ìƒê´€ì—†ì§€ë§Œ, ì´ ë°–ì—ëŠ” ìŠ¤í† ë¦¬ë¶ ì „ìš© `Provider`ë¥¼ í…Œì»¤ë ˆì´í„°ë¡œ ë§Œë“œëŠ” ê²ƒì´ ì¢‹ë‹¤.

```tsx
export const LoginUserInfoProviderDecorator = (
  Stroy: PartialStoryFn<ReactFramework, Args>
) => (
  <LoginUserInfoProvider>
    <Story />
  </LoginUserInfoProvider>
);
```

### 8.3.3 ë°ì»¤ë ˆì´í„° ê³ ì°¨ í•¨ìˆ˜
**ê³ ì°¨ í•¨ìˆ˜**ë¥¼ ì‘ì„±í•˜ë©´ ë°ì»¤ë ˆì´í„°ë¥¼ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

`<Toast>` ì»´í¬ë„ŒíŠ¸ì˜ ìŠ¤í† ë¦¬ `createDecorator`ë¼ëŠ” ê³ ì°¨ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì„¤ì •ì„ ìµœì†Œí™”í•œë‹¤.
```tsx
export const Succeed: Story = {
  decorators: [createDecorator({ message: "ì„±ê³µí–ˆìŠµë‹ˆë‹¤", style: "succeed" })],
};

export const Failed: Story = {
  decorators: [createDecorator({ message: "ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤", style: "failed" })],
};

export const Busy: Story = {
  decorators: [createDecorator({ message: "í†µì‹  ì¤‘ì…ë‹ˆë‹¤", style: "busy" })],
};

function createDecorator(defaultState?: Partial<ToastState>) {
  return function Decorator() {
    return (
      <ToastProvider defaultState={{ ...defaultState, isShown: true }}>
        {null}
      </ToastProvider>
    );
  };
}
```


## 8.4 ì›¹ APIì— ì˜ì¡´í•˜ëŠ” ìŠ¤í† ë¦¬ ë“±ë¡
ìŠ¤í† ë¦¬ì—ë„ ì›¹ APIê°€ í•„ìš”í•˜ë©°, ì´ì™€ ê°™ì´ UI ì»´í¬ë„ŒíŠ¸ëŠ” MSWë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

### 8.4.1 ì• ë“œì˜¨ ì„¤ì •
ìŠ¤í† ë¦¬ë¶ì—ì„œ MSWë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ `msw`ì™€ `msw-storybook-addon`ì„ ì„¤ì¹˜í•´ì•¼ í•œë‹¤.
```bash
$ npm install msw msw-storybook-addon --save-dev
```

ë‹¤ìŒìœ¼ë¡œ `.storybook/preview.js`ì—ì„œ `initialize` í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•´ MSWë¥¼ í™œì„±í™” í•œë‹¤.
```tsx
import { initialize, mswDecorator } from "msw-storybook-addon";
export const decorators = [mswDecorator];
initialize();
```

í”„ë¡œì íŠ¸ì— ì²˜ìŒ MSWë¥¼ ì„¤ì¹˜í•˜ë©´ pubilc ë””ë ‰í„°ë¦¬ì˜ ê²½ë¡œë¥¼ ë³€ê²½í•´ ì¤˜ì•¼ í•œë‹¤.
```bash
$ npm msw init <PUBLIC_DIR>
```

ìŠ¤í† ë¦¬ë¶ì—ì„œë„ public ë””ë ‰í„°ë¦¬ì˜ ê²½ë¡œë¥¼ ëª…ì‹œí•œë‹¤.
`.storybook/main.js`
```tsx
module.exports = {
  staticDirs: ["../public"],
}
```

### 8.4.2 ìš”ì²­ í•¸ë“¤ëŸ¬ ë³€ê²½
ë‹¤ë¥¸ `parameters`ì™€ ë™ì¼í•˜ê²Œ 'Global', 'Component', 'Story' ë‹¨ê³„ë³„ ì„¤ì •ì´ ê°€ëŠ¥í•˜ë‹¤.

- Global ë‹¨ê³„: ëª¨ë“  ìŠ¤í† ë¦¬ ì ìš©í•  ì„¤ì •(`.storybook/preview.js`)
- Component ë‹¨ê³„: ìŠ¤í† ë¦¬ íŒŒì¼ì— ì ìš©í•  ì„¤ì •(`export default`)
- Story ë‹¨ê³„: ê°œë³„ ìŠ¤í† ë¦¬ì— ì ìš©í•  ì„¤ì •(`export const`)

ëª¨ë“  ìŠ¤í† ë¦¬ì— ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ê°€ í•„ìš”í•˜ë‹¤ë©´ `.storybook/preview.js`ì— ì‚¬ìš©ì ì •ë³´ë¥¼ ë°˜í™˜í•˜ëŠ” `MSW` í•¸ë“¤ëŸ¬ë¥¼ Global ë‹¨ê³„ì— ì„¤ì •í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤
```tsx
export const NotLoggedIn: Story = {
  parameters: {
    msw: { 
      handlers: [
        rest.get("/api/my/profile", async (_, res, ctx) => {
          return res(ctx.status(200));
          ... ë¡œê·¸ì¸ ì •ë³´
        }),
      ], 
    },
  },
};
```

ìŠ¤í† ë¦¬ì— ì ìš©ë˜ëŠ” ìš°ì„ ìˆœìœ„ Story > Component > Global ì´ë‹¤. Story ì„¤ì •ìœ¼ë¡œ ë¯¸ë¡œê·¸ì¸ ìƒíƒœë¥¼ ë°˜í™˜í•˜ë„ë¡ ë®ì–´ì“¸ ìˆ˜ ìˆë‹¤.
```tsx
export const NotLoggedIn: Story = {
  parameters: {
    msw: { 
      handlers: [
        rest.get("/api/my/profile", async (_, res, ctx) => {
          return res(ctx.status(401));
        }),
      ], 
    },
  },
};
```

### 8.4.3 ê³ ì°¨ í•¨ìˆ˜ë¡œ ìš”ì²­ í•¸ë“¤ëŸ¬ ë¦¬íŒ©í„°ë§í•˜ê¸°
ë¡œê·¸ì¸ ì •ë³´ë¥¼ ì‘ë‹µí•˜ëŠ” URLì´ ë³€ê²½ë˜ë©´ Global, Story ì„¤ì • ëª¨ë‘ ìˆ˜ì •ì´ í•„ìš”í•˜ë‹¤ `handleGetMyProfile` ê³ ì°¨ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬íŒ©í„°ë§ì„ í•´ë³´ì
```tsx
msw: { handlers: [handleGetMyProfile({ status: 401 })] ,
//msw:{
//  handlers: [
//    rest.get("/api/my/profile", async (_, res, ctx) => {
//      return res(ctx.status(401));
//    })
//  ]
//}
```


## 8.5 Next.js Routerì— ì˜ì¡´í•˜ëŠ” ìŠ¤í† ë¦¬ ë“±ë¡
UI ì»´í¬ë„ŒíŠ¸ì—ëŠ” íŠ¹ì • URLì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ìˆë‹¤.<br>
`storybook-addon-next-router` ì• ë“œì˜¨ì„ ì¶”ê°€í•˜ë©´ `Router` ìƒíƒœë¥¼ ìŠ¤í† ë¦¬ë§ˆë‹¤ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

### 8.5.1 ì• ë“œì˜¨ ì„¤ì •
ì• ë“œì˜¨ì„ ì„¤ì¹˜í•˜ê³  `.storybook/main.js`, `.storybook/preview.js`ì— ì„¤ì •ì„ ì¶”ê°€í•œë‹¤.
```bash
$ npm install storybook-addon-next-router --save-dev
```

`.storybook/main.js`
```tsx
module.exports = {
  stories: ["../src/**/*.stories.@(js|jsx|ts|tsx)"],
  addons: ["storybook-addon-next-router"]
};
```

`.storybook/preview.js`
```tsx
import { RouterContext } from "next/dist/shared/lib/router-context";
export const parameters = {
  nextRouter: {
    Provider: RouterContext.Provider,
  },
};  
```

### 8.5.2 Routerì— ì˜ì¡´í•˜ëŠ” ìŠ¤í† ë¦¬ ë“±ë¡ ì˜ˆì‹œ
ë¸Œë¼ìš°ì € URLì— ë”°ë¼ í˜„ì¬ í™”ë©´ì— ì£¼í™©ìƒ‰ ì„ ì´ ê·¸ë ¤ì§„ë‹¤.
```tsx
export const RouteMyPosts: Story = {
  parameters: {
    nextRouter: { pathname: "/my/posts" },
  },
};

export const RouteMyPostsCreate: Story = {
  parameters: {
    nextRouter: { pathname: "/my/posts/create" },
  },
};
```
![image](https://github.com/user-attachments/assets/0c3c6b99-d027-4f04-a33f-8925e721f96f)

![image](https://github.com/user-attachments/assets/44ea63ed-2c2f-4cf2-910e-de22efe782d1)


## 8.6 Play functionì„ í™œìš©í•œ ì¸í„°ë™ì…˜ í…ŒìŠ¤íŠ¸
ì¸í„°ë™ì…˜ì„ í• ë‹¹í•˜ëŠ” ë°©ë²•ìœ¼ë¡œë„ ì¬í˜„í•  ìˆ˜ ìˆëŠ” ìƒí™©ë„ ìˆë‹¤. 'ë¬¸ì ì…ë ¥', 'focusout ì´ë²¤íŠ¸', 'ì „ì†¡ ë²„íŠ¼ í´ë¦­' ê°™ì€ í…ŒìŠ¤íŠ¸ë‹¤.


### 8.6.1 ì• ë“œì˜¨ ì„¤ì •
ì• ë“œì˜¨ì„ ì„¤ì¹˜í•˜ê³  `.storybook/main.js`ì— ì„¤ì •ì„ ì¶”ê°€í•œë‹¤.
```bash
$ npm install @storybook/testing-library @storybook/jest @storybook/addon-interactions --save-dev
```

`.storybook/main.js`
```tsx
module.exports = {
  stories: ["../src/**/*.stories.@(js|jsx|ts|tsx)"],
  addons: ["@storybook/addon-interactions"],
  features: {
    interactionsDebugger: true,
  },
};
```

### 8.6.2 ì¸í„°ë™ì…˜ í• ë‹¹
ìŠ¤í† ë¦¬ì— `play` í•¨ìˆ˜ë¥¼ ì„¤ì •í•œë‹¤. `jsdom` ë•Œì™€ ë™ì¼í•˜ê²Œ `userEvent`ë¥¼ ì‚¬ìš©í•˜ì—¬ í• ë‹¹í•œë‹¤.<br>
í…ŒìŠ¤íŒ…ì—ì„œ ì‚¬ìš©í•˜ëŠ” `getBy`ë‚˜ `userEvent`ì™€ ê±°ì˜ ë™ì¼í•œ APIì´ë¯€ë¡œ ìë™ìœ¼ë¡œ ë¬¸ìê°€ ì…ë ¥ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
```tsx
export const SucceedSaveAsDraft: Story = {
  play: async ({ canvasElement }) => {
    const canvas = within(canvasElement);
    await user.type(
      canvas.getByRole("textbox", { name: "ì œëª©" }),
      "ë‚˜ì˜ ê¸°ì‚¬"
    );
  },
};
```
![image](https://github.com/user-attachments/assets/28e85e08-e531-4500-929e-ac0495b5cf75)


### 8.6.3 ë‹¨ì–¸ë¬¸ ì‘ì„±
`@storybook/jest`ì˜ `expect` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ UI ì»´í¬ë„ŒíŠ¸ì— ì¸í„°ë™ì…˜ì„ í• ë‹¹í•œ ìƒíƒœì—ì„œ ë‹¨ì–¸ë¬¸ì„ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.<br>
ê³µê°œ ì—¬ë¶€ í† ê¸€ ìŠ¤ìœ„ì¹˜ë¥¼ í´ë¦­í•˜ë©´ ë²„íŠ¼ì˜ ë¬¸ìê°€ 'ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥'ì—ì„œ 'ê³µê°œí•˜ê¸°'ë¡œ ë³€ê²½ëœë‹¤.
```tsx
export const SavePublish: Story = {
  play: async ({ canvasElement }) => {
    await user.click(canvas.getByRole("switch", { name: "ê³µê°œ ì—¬ë¶€" }));
    await expect(
      canvas.getByRole("button", { name: "ê³µê°œí•˜ê¸°" })
    ).toBeInTheDocument();
  },
};
```
![image](https://github.com/user-attachments/assets/ae121c68-e763-44fa-9f28-77b0fd976c11)
![image](https://github.com/user-attachments/assets/c4fac4e1-8031-43c8-9d73-d13ea9220b3f)

ì•„ë¬´ê²ƒë„ ì…ë ¥í•˜ì§€ ì•Šê³  `ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥`ì„ ì‹œë„í•˜ë©´ ìœ íš¨ì„± ê²€ì‚¬ê°€ ì‹¤íŒ¨í•´ ì˜¤ë¥˜ê°€ í‘œì‹œëœë‹¤.
```tsx
export const FailedSaveAsDraft: Story = {
  play: async ({ canvasElement }) => {
    const canvas = within(canvasElement);
    await user.click(canvas.getByRole("button", { name: "ë¹„ê³µê°œ ìƒíƒœë¡œ ì €ì¥" }));
    const textbox = canvas.getByRole("textbox", { name: "ì œëª©" });
    await waitFor(() =>
      expect(textbox).toHaveErrorMessage("í•œ ê¸€ì ì´ìƒì˜ ë¬¸ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”")
    );
  },
};
```

ì´ì²˜ëŸ¼ Play functionìœ¼ë¡œ ìŠ¤í† ë¦¬ë¶ì—ì„œ ì¸í„°ë™ì…˜ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.


## 8.7 addon-a11yë¥¼ í™œìš©í•œ ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸
ìŠ¤í† ë¦¬ë¶ì€ ì»´í¬ë„ŒíŠ¸ ë‹¨ìœ„ë¡œ ì ‘ê·¼ì„±ì„ ê²€ì¦í•˜ëŠ” ìš©ë„ë¡œë„ í™œìš©ëœë‹¤.

### 8.7.1 ì• ë“œì˜¨ ì„¤ì •
`@storybook/addon-a11y` ì• ë“œì˜¨ì„ ì¶”ê°€í•˜ë©´ ìŠ¤í† ë¦¬ë¶ íƒìƒ‰ê¸°ì—ì„œ ì ‘ê·¼ì„± ê´€ë ¨ ìš°ë ¤ ì‚¬í•­ì„ ì•Œë ¤ì¤€ë‹¤.<br>
ì• ë“œì˜¨ì„ ì„¤ì¹˜í•˜ê³  `.storybook/main.js`ì— ì„¤ì •ì„ ì¶”ê°€í•œë‹¤.
```bash
$ npm install @storybook/addon-a11y --save-dev
```

`.storybook/main.js`
```tsx
module.exports = {
  stories: ["../src/**/*.stories.@(js|jsx|ts|tsx)"],
  addons: ["@storybook/addon-a11y"],
};
```

ë‹¤ë¥¸ `paraameters`ì™€ ë™ì¼í•˜ê²Œ ë‹¨ê³„ë³„ ì„¤ì •ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤. ë‹¨ê³„ ì„¤ëª… ìƒëµ..


### 8.7.2 ì ‘ê·¼ì„±ê³¼ ê´€ë ¨í•œ ì£¼ì˜ ì‚¬í•­ ì ê²€í•˜ê¸°
Accessibility íŒ¨ë„ì„ ì—´ì–´ë³´ë©´ ê²€ì¦í•œ ë‚´ìš©ì´ Violations(ë¹¨ê°„ìƒ‰) Passes(ì´ˆë¡ìƒ‰) Incomplete(ë…¸ë€ìƒ‰)ìœ¼ë¡œ êµ¬ë¶„ë¼ ìˆê³ , ë¹¨ê°„ìƒ‰ì€ ì ‘ê·¼ì„±ì„ ìœ„ë°˜í•˜ì—¬ ìˆ˜ì •ì´ í•„ìš”í•˜ë‹¤ëŠ” ì˜ë¯¸ë‹¤. <br>
'Highlight results'ë¥¼ ì²´í¬í•˜ë©´ ì ì„ ìœ¼ë¡œ í‘œì‹œë˜ë©´ì„œ ê°•ì¡°ëœë‹¤.
![image](https://github.com/user-attachments/assets/40e6670e-283f-4a3e-91f2-6ee1996543e5)


### 8.7.3 ì¼ë¶€ ê·œì¹™ ìœ„ë°˜ì„ ë¬´íš¨í™”í•˜ê¸°
ê·œì¹™ì´ ì§€ë‚˜ì¹˜ê²Œ ì—„ê²©í•˜ë‹¤ê³  ëŠë¼ê±°ë‚˜ ì›í•˜ì§€ ì•ŠëŠ” ì¼ë¶€ ë‚´ìš©ì„ ë¬´íš¨í™”í•  ìˆ˜ ìˆë‹¤.<br>
ì»´í¬ë„ŒíŠ¸ ë‹¨ìœ„ì—ì„œ ê·œì¹™ ë¬´íš¨í™”
```tsx
export default {
  component: Switch,
  parameters: {
    a11y: {
      config: { rules: [{ id: "label", enabled: false }] },
    },
  },
} as ComponentMeta<typeof Switch>;
```

> ğŸ’¡ **Rule í™•ì¸**
> 
> https://github.com/dequelabs/axe-core/blob/develop/doc/rule-descriptions.md
![image](https://github.com/user-attachments/assets/0a208f56-ea74-45c5-b414-b5ffaad56dde)


### 8.7.4 ì ‘ê·¼ì„± ê²€ì¦ ìƒëµí•˜ê¸°
ì ‘ê·¼ì„± ìì²´ë¥¼ ìƒëµí•˜ê³  ì‹¶ë‹¤ë©´ `parameters.a11y.disable`ì„ `true`ë¡œ ì„¤ì •í•˜ë©´ ëœë‹¤.
```tsx
export default {
  component: Switch,
  parameters: {
    a11y: { disable: true },
  },
} as ComponentMeta<typeof Switch>;
```

## 8.8 ìŠ¤í† ë¦¬ë¶ í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆ
ìŠ¤í† ë¦¬ë¶ í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆëŠ” ìŠ¤í† ë¦¬ë¥¼ ì‹¤í–‰ê°€ëŠ¥í•œ í…ŒìŠ¤íŠ¸ë¡œ ë³€í™˜í•œë‹¤. ì œìŠ¤íŠ¸ì™€ í”Œë ˆì´ë¼ì´íŠ¸ì—ì„œ ì‹¤í–‰ëœë‹¤. <br>
ìŠ¤í† ë¦¬ë¶ì—ì„œ ìŠ¤ëª¨í¬ í…ŒìŠ¤íŠ¸ëŠ” ë¬¼ë¡  Play finction, ì ‘ê·¼ì„± ìœ„ë°˜ ì‚¬í•­ì´ ìˆëŠ”ì§€ë„ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤.

### 8.8.1 í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆë¥¼ í™œìš©í•œ ì¼ë°˜ì ì¸ í…ŒìŠ¤íŠ¸ ìë™í™”
UI ì»´í¬ë„ŒíŠ¸ê°€ `Props`ê°€ ë³€ê²½ë˜ê±°ë‚˜ ì˜ì¡´í•˜ëŠ” ì›¹ APIì˜ ë°ì´í„°ê°€ ë³€ê²½ëë‹¤ë©´ ë“±ë¡ëœ ìŠ¤í† ë¦¬ì— ë³€ê²½ ì‚¬í•­ì„ ë°˜ì˜í•´ì•¼ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.

`@storybook/test-runner`ë¥¼ ì‚¬ìš©í•´ì„œ ë“±ë¡ëœ ìŠ¤í† ë¦¬ì— ì˜¤ë¥˜ê°€ ì—†ëŠ”ì§€ ê²€ì¦í•  ìˆ˜ ìˆë‹¤.
```bash
$ npm install @storybook/test-runner --save-dev
$ npm run test:storybook
```

### 8.8.2 í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆë¥¼ í™œìš©í•œ Play function í…ŒìŠ¤íŠ¸ ìë™í™”
Play function ìŠ¤í† ë¦¬ì—ë„ UI ì»´í¬ë„ŒíŠ¸ ë³€ê²½ ì‚¬í•­ì„ ë°˜ì˜í•˜ì§€ ì•Šìœ¼ë©´ ì¸í„°ë™ì…˜ì´ ì‹¤íŒ¨í•œë‹¤. <br>
í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆëŠ” Play functionì„ ìŠ¤í† ë¦¬ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì¸í„°ë™ì…˜ ì˜¤ë¥˜ ì—†ì´ ì •ìƒì ìœ¼ë¡œ ì¢…ë£ŒëëŠ”ì§€ ê²€ì¦í•œë‹¤.
![image](https://github.com/user-attachments/assets/2eee101e-9359-4687-8f3a-e6f49bf2b20a)
```tsx
const button = await canvas.findByRole("button", {
  name: "ë©”ë‰´ ì—´ê¸°",
});
await user.click(button);
const navigation = canvas.getByRole("navigation", {
  name: "ë„¤ë¹„ê²Œì´ì…˜",
});
await expect(navigation).toBeInTheDocument();
```
```tsx
//<nav aria-label="ë‚´ë¹„ê²Œì´ì…˜" className={styles.nav}>
<nav aria-label="ë©”ë‰´" className={styles.nav}>
```
![image](https://github.com/user-attachments/assets/e7d228cc-867b-4d88-88d7-ad146c834092)



### 8.8.3 í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆë¥¼ í™œìš©í•œ ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸ ìë™í™”
ìŠ¤í† ë¦¬ë¶ í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆëŠ” í”Œë ˆì´ë¼ì´íŠ¸ì™€ í—¤ë“œë¦¬ìŠ¤ ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ëœë‹¤. í”Œë ˆì´ë¼ì´íŠ¸ ê¸°ëŠ¥ë“¤ì„ í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆì—ì„œ í™œìš©í•  ìˆ˜ ìˆë‹¤. `axe-playwright`ëŠ” ì ‘ê·¼ì„± ë„ìš°ì¸ axeë¥¼ ì‚¬ìš©í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì ‘ê·¼ì„± ê´€ë ¨ ë¬¸ì œì ì„ ì°¾ëŠ”ë‹¤.
```tsx
const { getStoryContext } = require("@storybook/test-runner");
const { injectAxe, checkA11y, configureAxe } = require("axe-playwright");

module.exports = {
  async preRender(page, context) {
    if (context.name.startsWith("SP")) {
      page.setViewportSize({ width: 375, height: 667 });
    } else {
      page.setViewportSize({ width: 1280, height: 800 });
    }
    await injectAxe(page);
  },
  async postRender(page, context) {
    const storyContext = await getStoryContext(page, context);
    if (storyContext.parameters?.a11y?.disable) {
      return;
    }
    await configureAxe(page, {
      rules: storyContext.parameters?.a11y?.config?.rules,
    });
    await checkA11y(page, "#root", {
      includedImpacts: ["critical", "serious"], // ê²€ì¶œë˜ëŠ” ì˜¤ë¥˜ ìˆ˜ì¤€ì„ ì¡°ì • ê°€ëŠ¥.
      detailedReport: false,
      detailedReportOptions: { html: true },
      axeOptions: storyContext.parameters?.a11y?.options,
    });
  },
};
```

## 8.9 ìŠ¤í† ë¦¬ë¥¼ í†µí•© í…ŒìŠ¤íŠ¸ì— ì¬ì‚¬ìš©í•˜ê¸°
ì œìŠ¤íŠ¸ë¡œ ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œì™€ ë”ë¶ˆì–´ ìŠ¤í† ë¦¬ê¹Œì§€ ì»¤ë°‹í•´ì•¼ í•œë‹¤ë©´ ìš´ìš©ë¹„ê°€ ë„ˆë¬´ ë§ì´ ì¦ê°€í•œë‹¤. ìŠ¤í† ë¦¬ë¥¼ í†µí•© í…ŒìŠ¤íŠ¸ì— ì¬ì‚¬ìš©í•´ì„œ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

### 8.9.1 ìŠ¤í† ë¦¬ ì¬ì‚¬ìš©
```tsx
// ìŠ¤í† ë¦¬ ë“±ë¡ìš© í•¨ìˆ˜
function createDecorator(defaultState?: Partial<AlertDialogState>) {
  return function Decorator(Story: PartialStoryFn<ReactFramework, Args>) {
    return (
      <AlertDialogProvider defaultState={{ ...defaultState, isShown: true }}>
        <Story />
      </AlertDialogProvider>
    );
  };
}

// ì‹¤ì œë¡œ ë“±ë¡í•  ìŠ¤í† ë¦¬
export const Default: Story = {
  decorators: [createDecorator({ message: "ì„±ê³µí–ˆìŠµë‹ˆë‹¤" })],
};

export const CustomButtonLabel: Story = {
  decorators: [
    createDecorator({
      message: "ê¸°ì‚¬ë¥¼ ê³µê°œí•©ë‹ˆë‹¤. ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
      cancelButtonLabel: "CANCEL",
      okButtonLabel: "OK",
    }),
  ],
};

export const ExcludeCancel: Story = {
  decorators: [
    createDecorator({
      message: "ì „ì†¡ëìŠµë‹ˆë‹¤",
      cancelButtonLabel: undefined,
      okButtonLabel: "OK",
    }),
  ],
};
```

### 8.9.2 ìŠ¤í† ë¦¬ë¥¼ importí•˜ì—¬ í…ŒìŠ¤íŠ¸ ëŒ€ìƒìœ¼ë¡œ ë§Œë“¤ê¸°
í…ŒìŠ¤íŠ¸ ìŠ¤í† ë¦¬ë¥¼ `import`í•˜ë ¤ë¨¼ ì „ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ `@storybook/testing-react`ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
```bash
$ npm install --save-dev @storybook/testing-react
```

ìŠ¤í† ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜¤ê³ , `composeStories(stories)` ìŠ¤í† ë¦¬ ì„ ì–¸, ë‹¨ì–¸ë¬¸ì— ìŠ¤í† ë¦¬ `render`
```tsx
import { composeStories } from "@storybook/testing-react";
import { render, screen } from "@testing-library/react";
import * as stories from "./index.stories";   // ìŠ¤í† ë¦¬ íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¨ë‹¤.

const { Default, CustomButtonLabel, ExcludeCancel } = composeStories(stories);  // ì œìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ìŠ¤í† ë¦¬ë¥¼ ì„ ì–¸

describe("AlertDialog", () => {
  test("Default", () => {
    render(<Default />);  // ìŠ¤í† ë¦¬ ë Œë”ë§
    expect(screen.getByRole("alertdialog")).toBeInTheDocument();
  });

  test("CustomButtonLabel", () => {
    render(<CustomButtonLabel />); // ìŠ¤í† ë¦¬ ë Œë”ë§
    expect(screen.getByRole("button", { name: "OK" })).toBeInTheDocument();
    expect(
      screen.getByRole("button", { name: "CANCEL" })
    ).toBeInTheDocument();
  });

  test("ExcludeCancel", () => {
    render(<ExcludeCancel />); // ìŠ¤í† ë¦¬ ë Œë”ë§
    expect(screen.getByRole("button", { name: "OK" })).toBeInTheDocument();
    expect(
      screen.queryByRole("button", { name: "CANCEL" })
    ).not.toBeInTheDocument();
  });

//  ì¬ì‚¬ìš© ì „
//  test("ExcludeCancel", () => {
//    const state: AlertState = {  // ì´ˆê¸°ê°’ ì¤‘ë³µ ì…‹íŒ…
//      message: "ì „ì†¡ëìŠµë‹ˆë‹¤",
//      cancelButtonLabel: undefined,
//      okButtonLabel: "OK",
//    }
//    render(<AlertDialogProvider defaultState={state}></AlertDialogProvider>);
//    expect(screen.getByRole("button", { name: "OK" })).toBeInTheDocument();
//    expect(
//      screen.queryByRole("button", { name: "CANCEL" })
//    ).not.toBeInTheDocument();
//  });
});
```

### 8.9.3 @storybook/test-runnerì™€ì˜ ì°¨ì´ì 
- ì œìŠ¤íŠ¸ì—ì„œ ìŠ¤í† ë¦¬ë¥¼ ì¬ì‚¬ìš©í•  ë•Œì˜ ì¥ì 
  - ëª© ëª¨ë“ˆ í˜¹ì€ ìŠ¤íŒŒì´ê°€ í•„ìš”í•œ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.(ì œìŠ¤íŠ¸ì˜ ëª© í•¨ìˆ˜ ì‚¬ìš©)
  - ì‹¤í–‰ ì†ë„ê°€ ë¹ ë¥´ë‹¤. (í—¤ë“œë¦¬ìŠ¤ ë¸Œë¼ìš°ì €ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)
- í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆì˜ ì¥ì 
  - í…ŒìŠ¤íŠ¸ íŒŒì¼ì„ ë”°ë¡œ ë§Œë“¤ì§€ ì•Šì•„ë„ ëœë‹¤(ì ì€ ì‘ì—…ëŸ‰)
  - ì‹¤ì œ í™˜ê²½ê³¼ ìœ ì‚¬ì„±ì´ ë†’ë‹¤(ë¸Œë¼ìš°ì €ë¥¼ ì‚¬ìš©í•´ cssê°€ ì ìš©ëœ ìƒí™© ì¬í˜„ ê°€ëŠ¥)

