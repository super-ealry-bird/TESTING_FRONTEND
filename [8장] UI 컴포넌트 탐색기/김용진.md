# [8장] UI 컴포넌트 탐색기

---

## 8.1 스토리북 기초
UI 컴포넌트 탐색기는 구현된 UI 컴포넌트를 쉽게 공유할 수 있도록 도와주는 협업 도구다.
최근에는 UI 컴포넌트 탐색기를 협업 도구가 아닌 테스트에 활용하는 사례가 많아졌다.

기존의 프런트엔드 테스트는 다음의 두 가지 테스트를 의미했다.

- `jsdom`을 사용한 단위 테스트 및 통합테스트
- 브라우저를 사용한 E2E 테스트

스토리북의 UI컴포넌트 테스트는 이 두 가지 테스트의 중간에 위치한 테스트다.
![image](https://github.com/user-attachments/assets/e99d101e-ac17-4b37-85c7-16d917615d49)

### 8.1.1 스토리북 설치
스토리북 설치
```bash
$ npx storybook init
```

```bash
  storybook@8.2.9
Ok to proceed? (y)
```

스토리북 실행 http://localhost:6006/ 에 실행된다.
```bash
$ npm run storybook
```

### 8.1.2 스토리 등록
스토리를 등록하려면 프로젝트에 스토리 파일을 추가해야 한다.<br>
예제 코드 `Button.jsx`라는 UI 컴포넌트를 스토리 등록을 위해 필요한 스토리 파일 Button.stories.jsx 다.
```tsx
import { Button } from "./Button";

export default {
  title: "Example/Button",
  component: Button,
};
```

UI 컴포넌트 Props의 조합으로 다른 스타일과 작동을 제공할 수 있다.
Button 문자열을 표시할 때는 label 이라는 Props를 지정한다. ( 스토리북에서는 Props에 해당하는 변수명이 args 이다.)
```tsx
export const Default = {
  args: {
    label: "Button"
  }
};
```

size가 다른 `export` 객체 이름으로 개별 스토리 등록 
```tsx
export const Large = {
  args: {
    size: "large"
    label: "Button"
  }
};

export const Small = {
  args: {
    size: "small"
    label: "Button"
  }
};
```

### 8.1.3 3단계 깊은 병합
모든 스토리에는 'Global', Component', 'Story' 세 단계의 설정이 깊은 병합 방식으로 적용된다.

- Global 단계: 모든 스토리에 적용할 설정 (.storybook/preview.js)
- Component 단계: 스토리 파일에 적용할 설정 (export default)
- Story 단계: 개별 스토리에 적용할 설정 (export const)


## 8.2 스토리북 필수 애드온
스토리북은 애드온으로 필요한 기능을 추가할 수 있다. 설치시 기본적으로 추가되는 `@storybook/addon-essentials`은 필수 애드온 이다.

### 8.2.1 Controls를 활용한 디버깅
UI 컴포넌트는 Props에 전달된 값에 따라 다른 스타일과 기능을 제공한다. 스토리북 탐색기에서는 `Props`를 변경해 컴포넌트가 어떻게 표시되는지 실시간으로 디버깅할 수 있다. 이를 **Controls**라고 한다.

`Props`(`children`, `theme`, `variant`, `disabled`)를 변경하면 UI 컴포넌트가 어떻게 변화하는지 바로 확인할 수 있다.
![image](https://github.com/user-attachments/assets/548ffa1d-2b82-49e4-ab98-ebb491fcb9e5)

`@stroybook/addon-controls`라는 애드온이 제공하는 기능이며, 스도리북을 설치할 때 적용되는 `@storybook/addon-essentials`에 포함되어 있다.

### 8.2.2 Actions를 활용한 이벤트 핸들러 검증
UI 컴포넌트는 내부 로직을 처리할 때 `Props`로 전달받은 이벤트 핸들러를 호출하기도 한다. 이벤트 핸들러가 어떻게 호출됐는지 로그를 출력하는 기능이 **Actions**이며, `@stroybook/addon-actions`패키지에서 제공한다. `@storybook/addon-essentials`에 포함되어 있다.

title를 입력하지 않고, 저장하려고 하면 `onInvalid` 호출됐고 로그를 확인할 수 있다.
![image](https://github.com/user-attachments/assets/c24a1c83-3582-4768-969d-a9f22ceb7de6)


Global 단계 설정으로 `on`으로 시작하는 모든 이벤트 핸들러는 자동적으로 Actions 패널에 로그를 출력하게 된다.
핸들러 이름이 다른 경우 정규표현식을 수정해야 한다.
```tsx
export const parameters = {
  actions: { argTypesRegex: "^on[A-Z].*" },
};
```

### 8.2.3 반응형 대응을 위한 뷰포트 설정
반응형으로 구현한 UI 컴포넌트는 화면 크기별로 스토리를 등록할 수 있다. `@stroybook/addon-viewport`패키지에서 지원한다.

![image](https://github.com/user-attachments/assets/5cdd27d2-222f-4051-b93e-a7f0d34199d1)

SP(스마트폰) `SPStroy`라는 공통된 설정을 만들어 사용
```tsx
export const SPStory = {
  parameters: {
    viewport: {
      viewports: INITIAL_VIEWPORTS,
      defaultViewport: "iphone6",
    },
    screenshot: {
      viewport: {
        width: 375,
        height: 667,
        deviceScaleFactor: 1,
      },
      fullPage: false,
    },
  },
};

// 스마트폰 로그인 화면 
export const SPLoggedIn: Story = {
  parameters: {
    ...SPStory.parameters,
  },

// PC 로그인 화면 
export const PCLoggedIn: Story = {
  parameters: {
    ...PCStory.parameters,
  },
```
